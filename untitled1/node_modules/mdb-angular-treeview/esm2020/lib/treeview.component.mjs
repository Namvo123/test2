import { Component, Input, Output, EventEmitter, ViewEncapsulation, ChangeDetectionStrategy, ViewChildren, } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "mdb-angular-ui-kit/collapse";
import * as i3 from "mdb-angular-ui-kit/checkbox";
export class MdbTreeviewComponent {
    constructor(_renderer, _cdRef) {
        this._renderer = _renderer;
        this._cdRef = _cdRef;
        this.selectable = false;
        this.accordion = false;
        this.openOnClick = true;
        this.line = false;
        this.color = 'primary';
        this.rotationAngle = '90';
        this.selected = new EventEmitter();
        this.activeItemChange = new EventEmitter();
    }
    expand(id) {
        const node = this._deepFind(id, 'expandId');
        if (!node) {
            return;
        }
        this._expandParentsNode(node[this.textField]);
        node.collapsed = false;
        this._cdRef.markForCheck();
    }
    collapse() {
        this._collapseAll(this.nodes);
        this._cdRef.markForCheck();
    }
    _checkboxChange(element, node) {
        node[this.checkedField] = element.checked;
    }
    _handleCheckboxClick(element, isChecked, node) {
        const isParentField = () => node[this.childrenField];
        const toggleAllDirectChildrenCheckboxes = (actualNode, state) => {
            actualNode[this.childrenField].forEach((childrenNode) => {
                childrenNode[this.checkedField] = state;
            });
        };
        const toggleAllChildrenCheckboxes = (actualNode, state) => {
            toggleAllDirectChildrenCheckboxes(actualNode, state);
            actualNode[this.childrenField]?.forEach((childrenNode) => {
                if (childrenNode[this.childrenField]) {
                    toggleAllChildrenCheckboxes(childrenNode, state);
                }
            });
        };
        if (isChecked && isParentField()) {
            toggleAllChildrenCheckboxes(node, true);
        }
        if (!isChecked && isParentField()) {
            toggleAllChildrenCheckboxes(node, false);
        }
        node[this.checkedField] = element.checked;
        const iterator = (actualNode = this.nodes) => {
            actualNode.forEach((childrenNode) => {
                if (childrenNode[this.childrenField]) {
                    iterator(childrenNode[this.childrenField]);
                    let isAllChildrenChecked = childrenNode[this.childrenField].every((sibling) => sibling[this.checkedField] === true);
                    childrenNode[this.checkedField] = isAllChildrenChecked;
                }
            });
        };
        iterator(this.nodes);
    }
    checkboxSelected(node, isChecked) {
        if (isChecked) {
            this.selected.emit(node);
        }
    }
    setActive(target, preventClick) {
        if (preventClick) {
            return;
        }
        this.activeElement.forEach((element) => {
            this._renderer.removeClass(element.nativeElement, 'active');
        });
        this._renderer.addClass(target, 'active');
        this.activeItemChange.emit(target);
    }
    filter(value) {
        this.collapse();
        const node = this._deepFind(value, 'name');
        if (!node) {
            return;
        }
        this._expandParentsNode(node[this.textField]);
        node.collapsed = false;
        this._cdRef.markForCheck();
    }
    generateUid() {
        const uid = Math.random().toString(36).substr(2, 9);
        return `mdb-treeview-${uid}`;
    }
    _deepFind(value, key = this.textField) {
        let result;
        const findInNode = (nodes, value) => {
            nodes.forEach((node) => {
                const includes = node[key]?.toLowerCase().includes(value.toLowerCase());
                if (includes) {
                    result = node;
                }
                else if (node[this.childrenField]) {
                    findInNode(node[this.childrenField], value);
                }
            });
        };
        findInNode(this.nodes, value);
        return result;
    }
    _expandParentsNode(value, key = this.textField) {
        const findInNode = (nodes, value) => {
            nodes.forEach((parentNode) => {
                parentNode[this.childrenField]?.forEach((childrenNode) => {
                    const includes = childrenNode[key]?.toLowerCase().includes(value.toLowerCase());
                    if (includes) {
                        parentNode.collapsed = false;
                    }
                    else if (childrenNode[this.childrenField]) {
                        findInNode(parentNode[this.childrenField], value);
                    }
                });
            });
        };
        findInNode(this.nodes, value);
    }
    _collapseAll(nodes) {
        nodes.forEach((node) => {
            node.collapsed = true;
            if (node[this.childrenField]) {
                this._collapseAll(node[this.childrenField]);
            }
        });
    }
}
MdbTreeviewComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.2.3", ngImport: i0, type: MdbTreeviewComponent, deps: [{ token: i0.Renderer2 }, { token: i0.ChangeDetectorRef }], target: i0.ɵɵFactoryTarget.Component });
MdbTreeviewComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.2.3", type: MdbTreeviewComponent, selector: "mdb-treeview", inputs: { nodes: "nodes", textField: "textField", childrenField: "childrenField", checkedField: "checkedField", selectable: "selectable", checkboxesField: "checkboxesField", accordion: "accordion", openOnClick: "openOnClick", line: "line", color: "color", rotationAngle: "rotationAngle" }, outputs: { selected: "selected", activeItemChange: "activeItemChange" }, viewQueries: [{ propertyName: "activeElement", predicate: ["activeElement"], descendants: true }], exportAs: ["mdbTreeview"], ngImport: i0, template: "<!-- child nodes -->\n<ng-template #tree let-nodeChildren let-idx=\"idx\" let-disabled=\"disabled\">\n  <li\n    #activeElement\n    *ngFor=\"let node of nodeChildren; let n = index;\"\n    role=\"tree-item\"\n    [ngClass]=\"{'treeview-category': !node[childrenField], 'treeview-disabled': (node.disabled || disabled) && !node[childrenField]}\"\n    (click)=\"setActive($event.currentTarget, node[childrenField])\"\n  >\n    <ng-container *ngIf=\"!node[childrenField]\">\n      <ng-container *ngIf=\"selectable\" >\n        <ng-container *ngTemplateOutlet=\"checkboxTemplate; context: { $implicit: node, idx: idx + '_' + n, disabled: node.disabled || disabled}\"></ng-container>\n      </ng-container>\n      <ng-container *ngIf=\"!selectable\">\n        <i\n          *ngIf=\"node.icon\"\n          [ngClass]=\"node.icon\"\n          [ngStyle]=\"{'transform': node.collapsed === false ? 'rotate(' + rotationAngle + 'deg)' : 'rotate(0deg)'}\"\n        ></i>\n        {{ node[textField] }}\n      </ng-container>\n    </ng-container>\n    <a \n      #activeElement\n      *ngIf=\"node[childrenField] && node[childrenField].length > 0\"\n      class=\"treeview-category\"\n      role=\"button\"\n      [ngClass]=\"{'d-flex': selectable, 'treeview-disabled': node.disabled || disabled }\"\n      (click)=\"node.collapsed = node.collapsed === undefined ? false : !node.collapsed; setActive($event.currentTarget, false)\"\n    >\n      <span aria-label=\"toggle\">\n        <i\n          tabindex=\"1\"\n          [ngClass]=\"node.icon ? !selectable? node.icon : '' : 'fas fa-angle-right'\"\n          [ngStyle]=\"{'transform': node.collapsed === false ? 'rotate(' + rotationAngle + 'deg)' : 'rotate(0deg)'}\"\n          class=\"mx-1\"\n        ></i>\n      </span>\n      <ng-container *ngIf=\"selectable\" >\n        <ng-container *ngTemplateOutlet=\"checkboxTemplate; context: { $implicit: node, idx: idx + '_' + n, disabled: node.disabled || disabled }\"></ng-container>\n      </ng-container>\n      <ng-container *ngIf=\"!selectable\">\n        {{ node[textField] }}\n      </ng-container>\n    </a>\n    <ul \n      id=\"collapse-{{node.expandId}}-{{idx + '_' + n}}\"\n      mdbCollapse\n      [collapsed]=\"node.collapsed === false ? false : true\"\n      role=\"tree\"\n      [ngClass]=\"{'treeview-line': line}\"\n    >\n      <ng-container *ngTemplateOutlet=\"tree; context: { $implicit: node[childrenField], idx: idx + '_' + n, disabled: node.disabled || disabled }\"></ng-container>\n    </ul>\n  </li>\n</ng-template>\n\n<!-- selectable -->\n<ng-template #checkboxTemplate let-node let-idx=\"idx\" let-disabled=\"disabled\">\n  <div class=\"form-check\">\n    <input\n      mdbCheckbox\n      class=\"form-check-input\"\n      type=\"checkbox\"\n      value=\"\"\n      id=\"{{generateUid() + idx}}\"\n      [disabled]=\"disabled\"\n      (click)=\"_handleCheckboxClick($event.target, $event.target.checked, node); $event.stopPropagation()\"\n      (change)=\"_checkboxChange($event.target, node)\"\n      [checked]=\"node[checkedField]\"\n    />\n    <label class=\"form-check-label\" for=\"{{generateUid() + idx}}\">\n      <i\n        *ngIf=\"node.icon\"\n        [ngClass]=\"node.icon\"\n        [ngStyle]=\"{'transform': node.collapsed === false ? 'rotate(' + rotationAngle + 'deg)' : 'rotate(0deg)'}\"\n        ></i>\n      {{ node[textField] }}\n    </label>\n  </div>\n</ng-template>\n\n<!-- first nodes -->\n<div class=\"treeview treeview-{{color}}\">\n  <ul role=\"tree\">\n    <ng-container *ngTemplateOutlet=\"tree; context: { $implicit: nodes, idx: 1 }\"></ng-container>\n  </ul>\n</div>\n\n", directives: [{ type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i1.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet"] }, { type: i1.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }, { type: i2.MdbCollapseDirective, selector: "[mdbCollapse]", inputs: ["collapsed"], outputs: ["collapseShow", "collapseShown", "collapseHide", "collapseHidden"], exportAs: ["mdbCollapse"] }, { type: i3.MdbCheckboxDirective, selector: "[mdbCheckbox]", inputs: ["checked", "value", "disabled"], outputs: ["checkboxChange"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.2.3", ngImport: i0, type: MdbTreeviewComponent, decorators: [{
            type: Component,
            args: [{ selector: 'mdb-treeview', exportAs: 'mdbTreeview', encapsulation: ViewEncapsulation.None, changeDetection: ChangeDetectionStrategy.OnPush, template: "<!-- child nodes -->\n<ng-template #tree let-nodeChildren let-idx=\"idx\" let-disabled=\"disabled\">\n  <li\n    #activeElement\n    *ngFor=\"let node of nodeChildren; let n = index;\"\n    role=\"tree-item\"\n    [ngClass]=\"{'treeview-category': !node[childrenField], 'treeview-disabled': (node.disabled || disabled) && !node[childrenField]}\"\n    (click)=\"setActive($event.currentTarget, node[childrenField])\"\n  >\n    <ng-container *ngIf=\"!node[childrenField]\">\n      <ng-container *ngIf=\"selectable\" >\n        <ng-container *ngTemplateOutlet=\"checkboxTemplate; context: { $implicit: node, idx: idx + '_' + n, disabled: node.disabled || disabled}\"></ng-container>\n      </ng-container>\n      <ng-container *ngIf=\"!selectable\">\n        <i\n          *ngIf=\"node.icon\"\n          [ngClass]=\"node.icon\"\n          [ngStyle]=\"{'transform': node.collapsed === false ? 'rotate(' + rotationAngle + 'deg)' : 'rotate(0deg)'}\"\n        ></i>\n        {{ node[textField] }}\n      </ng-container>\n    </ng-container>\n    <a \n      #activeElement\n      *ngIf=\"node[childrenField] && node[childrenField].length > 0\"\n      class=\"treeview-category\"\n      role=\"button\"\n      [ngClass]=\"{'d-flex': selectable, 'treeview-disabled': node.disabled || disabled }\"\n      (click)=\"node.collapsed = node.collapsed === undefined ? false : !node.collapsed; setActive($event.currentTarget, false)\"\n    >\n      <span aria-label=\"toggle\">\n        <i\n          tabindex=\"1\"\n          [ngClass]=\"node.icon ? !selectable? node.icon : '' : 'fas fa-angle-right'\"\n          [ngStyle]=\"{'transform': node.collapsed === false ? 'rotate(' + rotationAngle + 'deg)' : 'rotate(0deg)'}\"\n          class=\"mx-1\"\n        ></i>\n      </span>\n      <ng-container *ngIf=\"selectable\" >\n        <ng-container *ngTemplateOutlet=\"checkboxTemplate; context: { $implicit: node, idx: idx + '_' + n, disabled: node.disabled || disabled }\"></ng-container>\n      </ng-container>\n      <ng-container *ngIf=\"!selectable\">\n        {{ node[textField] }}\n      </ng-container>\n    </a>\n    <ul \n      id=\"collapse-{{node.expandId}}-{{idx + '_' + n}}\"\n      mdbCollapse\n      [collapsed]=\"node.collapsed === false ? false : true\"\n      role=\"tree\"\n      [ngClass]=\"{'treeview-line': line}\"\n    >\n      <ng-container *ngTemplateOutlet=\"tree; context: { $implicit: node[childrenField], idx: idx + '_' + n, disabled: node.disabled || disabled }\"></ng-container>\n    </ul>\n  </li>\n</ng-template>\n\n<!-- selectable -->\n<ng-template #checkboxTemplate let-node let-idx=\"idx\" let-disabled=\"disabled\">\n  <div class=\"form-check\">\n    <input\n      mdbCheckbox\n      class=\"form-check-input\"\n      type=\"checkbox\"\n      value=\"\"\n      id=\"{{generateUid() + idx}}\"\n      [disabled]=\"disabled\"\n      (click)=\"_handleCheckboxClick($event.target, $event.target.checked, node); $event.stopPropagation()\"\n      (change)=\"_checkboxChange($event.target, node)\"\n      [checked]=\"node[checkedField]\"\n    />\n    <label class=\"form-check-label\" for=\"{{generateUid() + idx}}\">\n      <i\n        *ngIf=\"node.icon\"\n        [ngClass]=\"node.icon\"\n        [ngStyle]=\"{'transform': node.collapsed === false ? 'rotate(' + rotationAngle + 'deg)' : 'rotate(0deg)'}\"\n        ></i>\n      {{ node[textField] }}\n    </label>\n  </div>\n</ng-template>\n\n<!-- first nodes -->\n<div class=\"treeview treeview-{{color}}\">\n  <ul role=\"tree\">\n    <ng-container *ngTemplateOutlet=\"tree; context: { $implicit: nodes, idx: 1 }\"></ng-container>\n  </ul>\n</div>\n\n" }]
        }], ctorParameters: function () { return [{ type: i0.Renderer2 }, { type: i0.ChangeDetectorRef }]; }, propDecorators: { activeElement: [{
                type: ViewChildren,
                args: ['activeElement']
            }], nodes: [{
                type: Input
            }], textField: [{
                type: Input
            }], childrenField: [{
                type: Input
            }], checkedField: [{
                type: Input
            }], selectable: [{
                type: Input
            }], checkboxesField: [{
                type: Input
            }], accordion: [{
                type: Input
            }], openOnClick: [{
                type: Input
            }], line: [{
                type: Input
            }], color: [{
                type: Input
            }], rotationAngle: [{
                type: Input
            }], selected: [{
                type: Output
            }], activeItemChange: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJlZXZpZXcuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbWRiLWFuZ3VsYXItdHJlZXZpZXcvc3JjL2xpYi90cmVldmlldy5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi9wcm9qZWN0cy9tZGItYW5ndWxhci10cmVldmlldy9zcmMvbGliL3RyZWV2aWV3LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsS0FBSyxFQUNMLE1BQU0sRUFDTixZQUFZLEVBQ1osaUJBQWlCLEVBQ2pCLHVCQUF1QixFQUN2QixZQUFZLEdBS2IsTUFBTSxlQUFlLENBQUM7Ozs7O0FBVXZCLE1BQU0sT0FBTyxvQkFBb0I7SUFrQi9CLFlBQW9CLFNBQW9CLEVBQVUsTUFBeUI7UUFBdkQsY0FBUyxHQUFULFNBQVMsQ0FBVztRQUFVLFdBQU0sR0FBTixNQUFNLENBQW1CO1FBWGxFLGVBQVUsR0FBRyxLQUFLLENBQUM7UUFFbkIsY0FBUyxHQUFHLEtBQUssQ0FBQztRQUNsQixnQkFBVyxHQUFHLElBQUksQ0FBQztRQUNuQixTQUFJLEdBQUcsS0FBSyxDQUFDO1FBQ2IsVUFBSyxHQUFHLFNBQVMsQ0FBQztRQUNsQixrQkFBYSxHQUFHLElBQUksQ0FBQztRQUVwQixhQUFRLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUM5QixxQkFBZ0IsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO0lBRThCLENBQUM7SUFFL0UsTUFBTSxDQUFDLEVBQVU7UUFDZixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsRUFBRSxVQUFVLENBQUMsQ0FBQztRQUU1QyxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1QsT0FBTztTQUNSO1FBRUQsSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztRQUU5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c0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBJbnB1dCxcbiAgT3V0cHV0LFxuICBFdmVudEVtaXR0ZXIsXG4gIFZpZXdFbmNhcHN1bGF0aW9uLFxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgVmlld0NoaWxkcmVuLFxuICBRdWVyeUxpc3QsXG4gIFJlbmRlcmVyMixcbiAgRWxlbWVudFJlZixcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5AQ29tcG9uZW50KHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEBhbmd1bGFyLWVzbGludC9jb21wb25lbnQtc2VsZWN0b3JcbiAgc2VsZWN0b3I6ICdtZGItdHJlZXZpZXcnLFxuICBleHBvcnRBczogJ21kYlRyZWV2aWV3JyxcbiAgdGVtcGxhdGVVcmw6ICd0cmVldmlldy5jb21wb25lbnQuaHRtbCcsXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBNZGJUcmVldmlld0NvbXBvbmVudCB7XG4gIEBWaWV3Q2hpbGRyZW4oJ2FjdGl2ZUVsZW1lbnQnKSBhY3RpdmVFbGVtZW50OiBRdWVyeUxpc3Q8RWxlbWVudFJlZj47XG5cbiAgQElucHV0KCkgbm9kZXM6IGFueTtcbiAgQElucHV0KCkgdGV4dEZpZWxkOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGNoaWxkcmVuRmllbGQ6IHN0cmluZztcbiAgQElucHV0KCkgY2hlY2tlZEZpZWxkOiBzdHJpbmc7XG4gIEBJbnB1dCgpIHNlbGVjdGFibGUgPSBmYWxzZTtcbiAgQElucHV0KCkgY2hlY2tib3hlc0ZpZWxkOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGFjY29yZGlvbiA9IGZhbHNlO1xuICBASW5wdXQoKSBvcGVuT25DbGljayA9IHRydWU7XG4gIEBJbnB1dCgpIGxpbmUgPSBmYWxzZTtcbiAgQElucHV0KCkgY29sb3IgPSAncHJpbWFyeSc7XG4gIEBJbnB1dCgpIHJvdGF0aW9uQW5nbGUgPSAnOTAnO1xuXG4gIEBPdXRwdXQoKSBzZWxlY3RlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgQE91dHB1dCgpIGFjdGl2ZUl0ZW1DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBfcmVuZGVyZXI6IFJlbmRlcmVyMiwgcHJpdmF0ZSBfY2RSZWY6IENoYW5nZURldGVjdG9yUmVmKSB7fVxuXG4gIGV4cGFuZChpZDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3Qgbm9kZSA9IHRoaXMuX2RlZXBGaW5kKGlkLCAnZXhwYW5kSWQnKTtcblxuICAgIGlmICghbm9kZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuX2V4cGFuZFBhcmVudHNOb2RlKG5vZGVbdGhpcy50ZXh0RmllbGRdKTtcblxuICAgIG5vZGUuY29sbGFwc2VkID0gZmFsc2U7XG5cbiAgICB0aGlzLl9jZFJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgfVxuXG4gIGNvbGxhcHNlKCk6IHZvaWQge1xuICAgIHRoaXMuX2NvbGxhcHNlQWxsKHRoaXMubm9kZXMpO1xuICAgIHRoaXMuX2NkUmVmLm1hcmtGb3JDaGVjaygpO1xuICB9XG5cbiAgX2NoZWNrYm94Q2hhbmdlKGVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsIG5vZGU6IGFueSk6IHZvaWQge1xuICAgIG5vZGVbdGhpcy5jaGVja2VkRmllbGRdID0gZWxlbWVudC5jaGVja2VkO1xuICB9XG5cbiAgX2hhbmRsZUNoZWNrYm94Q2xpY2soZWxlbWVudDogSFRNTElucHV0RWxlbWVudCwgaXNDaGVja2VkOiBib29sZWFuLCBub2RlOiBhbnkpOiB2b2lkIHtcbiAgICBjb25zdCBpc1BhcmVudEZpZWxkID0gKCkgPT4gbm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdO1xuXG4gICAgY29uc3QgdG9nZ2xlQWxsRGlyZWN0Q2hpbGRyZW5DaGVja2JveGVzID0gKGFjdHVhbE5vZGU6IGFueSwgc3RhdGU6IGJvb2xlYW4pOiB2b2lkID0+IHtcbiAgICAgIGFjdHVhbE5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXS5mb3JFYWNoKChjaGlsZHJlbk5vZGUpID0+IHtcbiAgICAgICAgY2hpbGRyZW5Ob2RlW3RoaXMuY2hlY2tlZEZpZWxkXSA9IHN0YXRlO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIGNvbnN0IHRvZ2dsZUFsbENoaWxkcmVuQ2hlY2tib3hlcyA9IChhY3R1YWxOb2RlOiBhbnksIHN0YXRlOiBib29sZWFuKTogdm9pZCA9PiB7XG4gICAgICB0b2dnbGVBbGxEaXJlY3RDaGlsZHJlbkNoZWNrYm94ZXMoYWN0dWFsTm9kZSwgc3RhdGUpO1xuICAgICAgYWN0dWFsTm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdPy5mb3JFYWNoKChjaGlsZHJlbk5vZGUpID0+IHtcbiAgICAgICAgaWYgKGNoaWxkcmVuTm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdKSB7XG4gICAgICAgICAgdG9nZ2xlQWxsQ2hpbGRyZW5DaGVja2JveGVzKGNoaWxkcmVuTm9kZSwgc3RhdGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgaWYgKGlzQ2hlY2tlZCAmJiBpc1BhcmVudEZpZWxkKCkpIHtcbiAgICAgIHRvZ2dsZUFsbENoaWxkcmVuQ2hlY2tib3hlcyhub2RlLCB0cnVlKTtcbiAgICB9XG4gICAgaWYgKCFpc0NoZWNrZWQgJiYgaXNQYXJlbnRGaWVsZCgpKSB7XG4gICAgICB0b2dnbGVBbGxDaGlsZHJlbkNoZWNrYm94ZXMobm9kZSwgZmFsc2UpO1xuICAgIH1cblxuICAgIG5vZGVbdGhpcy5jaGVja2VkRmllbGRdID0gZWxlbWVudC5jaGVja2VkO1xuXG4gICAgY29uc3QgaXRlcmF0b3IgPSAoYWN0dWFsTm9kZTogYW55ID0gdGhpcy5ub2Rlcyk6IHZvaWQgPT4ge1xuICAgICAgYWN0dWFsTm9kZS5mb3JFYWNoKChjaGlsZHJlbk5vZGUpID0+IHtcbiAgICAgICAgaWYgKGNoaWxkcmVuTm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdKSB7XG4gICAgICAgICAgaXRlcmF0b3IoY2hpbGRyZW5Ob2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0pO1xuICAgICAgICAgIGxldCBpc0FsbENoaWxkcmVuQ2hlY2tlZCA9IGNoaWxkcmVuTm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdLmV2ZXJ5KFxuICAgICAgICAgICAgKHNpYmxpbmcpID0+IHNpYmxpbmdbdGhpcy5jaGVja2VkRmllbGRdID09PSB0cnVlXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIGNoaWxkcmVuTm9kZVt0aGlzLmNoZWNrZWRGaWVsZF0gPSBpc0FsbENoaWxkcmVuQ2hlY2tlZDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICBpdGVyYXRvcih0aGlzLm5vZGVzKTtcbiAgfVxuXG4gIGNoZWNrYm94U2VsZWN0ZWQobm9kZTogYW55LCBpc0NoZWNrZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBpZiAoaXNDaGVja2VkKSB7XG4gICAgICB0aGlzLnNlbGVjdGVkLmVtaXQobm9kZSk7XG4gICAgfVxuICB9XG5cbiAgc2V0QWN0aXZlKHRhcmdldDogRWxlbWVudFJlZiwgcHJldmVudENsaWNrOiBib29sZWFuKTogdm9pZCB7XG4gICAgaWYgKHByZXZlbnRDbGljaykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuYWN0aXZlRWxlbWVudC5mb3JFYWNoKChlbGVtZW50OiBFbGVtZW50UmVmKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlci5yZW1vdmVDbGFzcyhlbGVtZW50Lm5hdGl2ZUVsZW1lbnQsICdhY3RpdmUnKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKHRhcmdldCwgJ2FjdGl2ZScpO1xuXG4gICAgdGhpcy5hY3RpdmVJdGVtQ2hhbmdlLmVtaXQodGFyZ2V0KTtcbiAgfVxuXG4gIGZpbHRlcih2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5jb2xsYXBzZSgpO1xuXG4gICAgY29uc3Qgbm9kZSA9IHRoaXMuX2RlZXBGaW5kKHZhbHVlLCAnbmFtZScpO1xuXG4gICAgaWYgKCFub2RlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fZXhwYW5kUGFyZW50c05vZGUobm9kZVt0aGlzLnRleHRGaWVsZF0pO1xuXG4gICAgbm9kZS5jb2xsYXBzZWQgPSBmYWxzZTtcblxuICAgIHRoaXMuX2NkUmVmLm1hcmtGb3JDaGVjaygpO1xuICB9XG5cbiAgZ2VuZXJhdGVVaWQoKTogc3RyaW5nIHtcbiAgICBjb25zdCB1aWQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSk7XG4gICAgcmV0dXJuIGBtZGItdHJlZXZpZXctJHt1aWR9YDtcbiAgfVxuXG4gIHByaXZhdGUgX2RlZXBGaW5kKHZhbHVlOiBzdHJpbmcsIGtleTogc3RyaW5nID0gdGhpcy50ZXh0RmllbGQpOiBhbnkge1xuICAgIGxldCByZXN1bHQ6IGFueTtcblxuICAgIGNvbnN0IGZpbmRJbk5vZGUgPSAobm9kZXM6IGFueVtdLCB2YWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgICBub2Rlcy5mb3JFYWNoKChub2RlOiBhbnkpID0+IHtcbiAgICAgICAgY29uc3QgaW5jbHVkZXMgPSBub2RlW2tleV0/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModmFsdWUudG9Mb3dlckNhc2UoKSk7XG5cbiAgICAgICAgaWYgKGluY2x1ZGVzKSB7XG4gICAgICAgICAgcmVzdWx0ID0gbm9kZTtcbiAgICAgICAgfSBlbHNlIGlmIChub2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0pIHtcbiAgICAgICAgICBmaW5kSW5Ob2RlKG5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgZmluZEluTm9kZSh0aGlzLm5vZGVzLCB2YWx1ZSk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHJpdmF0ZSBfZXhwYW5kUGFyZW50c05vZGUodmFsdWU6IHN0cmluZywga2V5OiBzdHJpbmcgPSB0aGlzLnRleHRGaWVsZCk6IHZvaWQge1xuICAgIGNvbnN0IGZpbmRJbk5vZGUgPSAobm9kZXM6IGFueSwgdmFsdWU6IHN0cmluZykgPT4ge1xuICAgICAgbm9kZXMuZm9yRWFjaCgocGFyZW50Tm9kZTogYW55KSA9PiB7XG4gICAgICAgIHBhcmVudE5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXT8uZm9yRWFjaCgoY2hpbGRyZW5Ob2RlOiBhbnkpID0+IHtcbiAgICAgICAgICBjb25zdCBpbmNsdWRlcyA9IGNoaWxkcmVuTm9kZVtrZXldPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHZhbHVlLnRvTG93ZXJDYXNlKCkpO1xuXG4gICAgICAgICAgaWYgKGluY2x1ZGVzKSB7XG4gICAgICAgICAgICBwYXJlbnROb2RlLmNvbGxhcHNlZCA9IGZhbHNlO1xuICAgICAgICAgIH0gZWxzZSBpZiAoY2hpbGRyZW5Ob2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0pIHtcbiAgICAgICAgICAgIGZpbmRJbk5vZGUocGFyZW50Tm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdLCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBmaW5kSW5Ob2RlKHRoaXMubm9kZXMsIHZhbHVlKTtcbiAgfVxuXG4gIHByaXZhdGUgX2NvbGxhcHNlQWxsKG5vZGVzOiBhbnkpOiB2b2lkIHtcbiAgICBub2Rlcy5mb3JFYWNoKChub2RlOiBhbnkpID0+IHtcbiAgICAgIG5vZGUuY29sbGFwc2VkID0gdHJ1ZTtcblxuICAgICAgaWYgKG5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXSkge1xuICAgICAgICB0aGlzLl9jb2xsYXBzZUFsbChub2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCI8IS0tIGNoaWxkIG5vZGVzIC0tPlxuPG5nLXRlbXBsYXRlICN0cmVlIGxldC1ub2RlQ2hpbGRyZW4gbGV0LWlkeD1cImlkeFwiIGxldC1kaXNhYmxlZD1cImRpc2FibGVkXCI+XG4gIDxsaVxuICAgICNhY3RpdmVFbGVtZW50XG4gICAgKm5nRm9yPVwibGV0IG5vZGUgb2Ygbm9kZUNoaWxkcmVuOyBsZXQgbiA9IGluZGV4O1wiXG4gICAgcm9sZT1cInRyZWUtaXRlbVwiXG4gICAgW25nQ2xhc3NdPVwieyd0cmVldmlldy1jYXRlZ29yeSc6ICFub2RlW2NoaWxkcmVuRmllbGRdLCAndHJlZXZpZXctZGlzYWJsZWQnOiAobm9kZS5kaXNhYmxlZCB8fCBkaXNhYmxlZCkgJiYgIW5vZGVbY2hpbGRyZW5GaWVsZF19XCJcbiAgICAoY2xpY2spPVwic2V0QWN0aXZlKCRldmVudC5jdXJyZW50VGFyZ2V0LCBub2RlW2NoaWxkcmVuRmllbGRdKVwiXG4gID5cbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIW5vZGVbY2hpbGRyZW5GaWVsZF1cIj5cbiAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJzZWxlY3RhYmxlXCIgPlxuICAgICAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwiY2hlY2tib3hUZW1wbGF0ZTsgY29udGV4dDogeyAkaW1wbGljaXQ6IG5vZGUsIGlkeDogaWR4ICsgJ18nICsgbiwgZGlzYWJsZWQ6IG5vZGUuZGlzYWJsZWQgfHwgZGlzYWJsZWR9XCI+PC9uZy1jb250YWluZXI+XG4gICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCIhc2VsZWN0YWJsZVwiPlxuICAgICAgICA8aVxuICAgICAgICAgICpuZ0lmPVwibm9kZS5pY29uXCJcbiAgICAgICAgICBbbmdDbGFzc109XCJub2RlLmljb25cIlxuICAgICAgICAgIFtuZ1N0eWxlXT1cInsndHJhbnNmb3JtJzogbm9kZS5jb2xsYXBzZWQgPT09IGZhbHNlID8gJ3JvdGF0ZSgnICsgcm90YXRpb25BbmdsZSArICdkZWcpJyA6ICdyb3RhdGUoMGRlZyknfVwiXG4gICAgICAgID48L2k+XG4gICAgICAgIHt7IG5vZGVbdGV4dEZpZWxkXSB9fVxuICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgPC9uZy1jb250YWluZXI+XG4gICAgPGEgXG4gICAgICAjYWN0aXZlRWxlbWVudFxuICAgICAgKm5nSWY9XCJub2RlW2NoaWxkcmVuRmllbGRdICYmIG5vZGVbY2hpbGRyZW5GaWVsZF0ubGVuZ3RoID4gMFwiXG4gICAgICBjbGFzcz1cInRyZWV2aWV3LWNhdGVnb3J5XCJcbiAgICAgIHJvbGU9XCJidXR0b25cIlxuICAgICAgW25nQ2xhc3NdPVwieydkLWZsZXgnOiBzZWxlY3RhYmxlLCAndHJlZXZpZXctZGlzYWJsZWQnOiBub2RlLmRpc2FibGVkIHx8IGRpc2FibGVkIH1cIlxuICAgICAgKGNsaWNrKT1cIm5vZGUuY29sbGFwc2VkID0gbm9kZS5jb2xsYXBzZWQgPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogIW5vZGUuY29sbGFwc2VkOyBzZXRBY3RpdmUoJGV2ZW50LmN1cnJlbnRUYXJnZXQsIGZhbHNlKVwiXG4gICAgPlxuICAgICAgPHNwYW4gYXJpYS1sYWJlbD1cInRvZ2dsZVwiPlxuICAgICAgICA8aVxuICAgICAgICAgIHRhYmluZGV4PVwiMVwiXG4gICAgICAgICAgW25nQ2xhc3NdPVwibm9kZS5pY29uID8gIXNlbGVjdGFibGU/IG5vZGUuaWNvbiA6ICcnIDogJ2ZhcyBmYS1hbmdsZS1yaWdodCdcIlxuICAgICAgICAgIFtuZ1N0eWxlXT1cInsndHJhbnNmb3JtJzogbm9kZS5jb2xsYXBzZWQgPT09IGZhbHNlID8gJ3JvdGF0ZSgnICsgcm90YXRpb25BbmdsZSArICdkZWcpJyA6ICdyb3RhdGUoMGRlZyknfVwiXG4gICAgICAgICAgY2xhc3M9XCJteC0xXCJcbiAgICAgICAgPjwvaT5cbiAgICAgIDwvc3Bhbj5cbiAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJzZWxlY3RhYmxlXCIgPlxuICAgICAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwiY2hlY2tib3hUZW1wbGF0ZTsgY29udGV4dDogeyAkaW1wbGljaXQ6IG5vZGUsIGlkeDogaWR4ICsgJ18nICsgbiwgZGlzYWJsZWQ6IG5vZGUuZGlzYWJsZWQgfHwgZGlzYWJsZWQgfVwiPjwvbmctY29udGFpbmVyPlxuICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIXNlbGVjdGFibGVcIj5cbiAgICAgICAge3sgbm9kZVt0ZXh0RmllbGRdIH19XG4gICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICA8L2E+XG4gICAgPHVsIFxuICAgICAgaWQ9XCJjb2xsYXBzZS17e25vZGUuZXhwYW5kSWR9fS17e2lkeCArICdfJyArIG59fVwiXG4gICAgICBtZGJDb2xsYXBzZVxuICAgICAgW2NvbGxhcHNlZF09XCJub2RlLmNvbGxhcHNlZCA9PT0gZmFsc2UgPyBmYWxzZSA6IHRydWVcIlxuICAgICAgcm9sZT1cInRyZWVcIlxuICAgICAgW25nQ2xhc3NdPVwieyd0cmVldmlldy1saW5lJzogbGluZX1cIlxuICAgID5cbiAgICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJ0cmVlOyBjb250ZXh0OiB7ICRpbXBsaWNpdDogbm9kZVtjaGlsZHJlbkZpZWxkXSwgaWR4OiBpZHggKyAnXycgKyBuLCBkaXNhYmxlZDogbm9kZS5kaXNhYmxlZCB8fCBkaXNhYmxlZCB9XCI+PC9uZy1jb250YWluZXI+XG4gICAgPC91bD5cbiAgPC9saT5cbjwvbmctdGVtcGxhdGU+XG5cbjwhLS0gc2VsZWN0YWJsZSAtLT5cbjxuZy10ZW1wbGF0ZSAjY2hlY2tib3hUZW1wbGF0ZSBsZXQtbm9kZSBsZXQtaWR4PVwiaWR4XCIgbGV0LWRpc2FibGVkPVwiZGlzYWJsZWRcIj5cbiAgPGRpdiBjbGFzcz1cImZvcm0tY2hlY2tcIj5cbiAgICA8aW5wdXRcbiAgICAgIG1kYkNoZWNrYm94XG4gICAgICBjbGFzcz1cImZvcm0tY2hlY2staW5wdXRcIlxuICAgICAgdHlwZT1cImNoZWNrYm94XCJcbiAgICAgIHZhbHVlPVwiXCJcbiAgICAgIGlkPVwie3tnZW5lcmF0ZVVpZCgpICsgaWR4fX1cIlxuICAgICAgW2Rpc2FibGVkXT1cImRpc2FibGVkXCJcbiAgICAgIChjbGljayk9XCJfaGFuZGxlQ2hlY2tib3hDbGljaygkZXZlbnQudGFyZ2V0LCAkZXZlbnQudGFyZ2V0LmNoZWNrZWQsIG5vZGUpOyAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcIlxuICAgICAgKGNoYW5nZSk9XCJfY2hlY2tib3hDaGFuZ2UoJGV2ZW50LnRhcmdldCwgbm9kZSlcIlxuICAgICAgW2NoZWNrZWRdPVwibm9kZVtjaGVja2VkRmllbGRdXCJcbiAgICAvPlxuICAgIDxsYWJlbCBjbGFzcz1cImZvcm0tY2hlY2stbGFiZWxcIiBmb3I9XCJ7e2dlbmVyYXRlVWlkKCkgKyBpZHh9fVwiPlxuICAgICAgPGlcbiAgICAgICAgKm5nSWY9XCJub2RlLmljb25cIlxuICAgICAgICBbbmdDbGFzc109XCJub2RlLmljb25cIlxuICAgICAgICBbbmdTdHlsZV09XCJ7J3RyYW5zZm9ybSc6IG5vZGUuY29sbGFwc2VkID09PSBmYWxzZSA/ICdyb3RhdGUoJyArIHJvdGF0aW9uQW5nbGUgKyAnZGVnKScgOiAncm90YXRlKDBkZWcpJ31cIlxuICAgICAgICA+PC9pPlxuICAgICAge3sgbm9kZVt0ZXh0RmllbGRdIH19XG4gICAgPC9sYWJlbD5cbiAgPC9kaXY+XG48L25nLXRlbXBsYXRlPlxuXG48IS0tIGZpcnN0IG5vZGVzIC0tPlxuPGRpdiBjbGFzcz1cInRyZWV2aWV3IHRyZWV2aWV3LXt7Y29sb3J9fVwiPlxuICA8dWwgcm9sZT1cInRyZWVcIj5cbiAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwidHJlZTsgY29udGV4dDogeyAkaW1wbGljaXQ6IG5vZGVzLCBpZHg6IDEgfVwiPjwvbmctY29udGFpbmVyPlxuICA8L3VsPlxuPC9kaXY+XG5cbiJdfQ==