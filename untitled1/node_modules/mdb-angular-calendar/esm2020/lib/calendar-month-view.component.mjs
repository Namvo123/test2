import { EventEmitter, Component, Input, Output, ViewChildren, } from '@angular/core';
import { getFirstDayOfWeek, getDaysInMonth, getMonth, addMonths, createDate, isSameDate, getToday, getDate, getYear, endOfDay, startOfDay, generateEvent, getEvents, differenceInDays, addDays, convertDateTo12h, } from './calendar.utils';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "mdb-angular-ui-kit/tooltip";
export class MdbCalendarMonthViewComponent {
    constructor(_renderer) {
        this._renderer = _renderer;
        this.dayClicked = new EventEmitter();
        this.eventClicked = new EventEmitter();
        this.eventDragged = new EventEmitter();
        this.dates = [];
        this.isDragging = false;
    }
    get activeDate() {
        return this._activeDate;
    }
    set activeDate(date) {
        this._activeDate = date;
        this.dates = this._generateDayView();
    }
    get events() {
        return this._events;
    }
    set events(events) {
        this._events = events;
        this.dates = this._generateDayView();
    }
    ngOnInit() {
        this.weekdays = this._getWeekdays();
        this.dates = this._generateDayView();
    }
    ngAfterViewInit() {
        this.daysEl = this.days.toArray().map((el) => el.nativeElement);
    }
    onEventClick(event) {
        if (this.readonly) {
            return;
        }
        this.eventClicked.emit(event);
    }
    onDayClick(day) {
        if (this.readonly) {
            return;
        }
        const newCalendarEvent = generateEvent(day.date);
        this.dayClicked.emit(newCalendarEvent);
    }
    onMouseDown(event, day) {
        if (this.readonly) {
            return;
        }
        this.isDragging = true;
        this.dragStart = this.daysEl.indexOf(event.target);
        this.selectionStartDay = day.date;
    }
    onMouseUp(event, day) {
        if (this.readonly) {
            return;
        }
        this.isDragging = false;
        this.dragEnd = this.daysEl.indexOf(event.target);
        if (this.dragEnd !== 0) {
            this.selectRange();
        }
        this.clearSelection();
        this.selectionEndDay = day.date;
        if (this.selectionStartDay === this.selectionEndDay) {
            return;
        }
        const newCalendarEvent = generateEvent(this.selectionStartDay, this.selectionEndDay);
        this.dayClicked.emit(newCalendarEvent);
    }
    onMouseMove(event) {
        if (this.readonly) {
            return;
        }
        event.preventDefault();
        if (this.isDragging) {
            this.dragEnd = this.daysEl.indexOf(event.target);
            this.selectRange();
        }
    }
    onEventDragStart(calendarEvent) {
        this.draggedEventId = calendarEvent.id;
        this.clearSelection();
    }
    onEventDragEnd(calendarEvent) {
        this.draggedEventId = '';
        this.hoveredEventId = '';
        const daysDifference = differenceInDays(calendarEvent.startDate, this.dragTargetDay.date);
        const newStartDate = addDays(calendarEvent.startDate, daysDifference);
        const newEndDate = addDays(calendarEvent.endDate, daysDifference);
        const newEvent = {
            ...calendarEvent,
            startDate: newStartDate,
            endDate: newEndDate,
            order: '',
        };
        this.eventDragged.emit(newEvent);
    }
    onDragEnter(event, day) {
        this._renderer.addClass(event.target, 'dragenter');
        this.dragTargetDay = day;
    }
    onDragLeave(event) {
        this._renderer.removeClass(event.target, 'dragenter');
    }
    onDragOver(event) {
        if (event.preventDefault) {
            event.preventDefault();
        }
        return false;
    }
    onMouseEnter(event) {
        this.hoveredEventId = event.id;
    }
    onMouseLeave() {
        this.hoveredEventId = '';
    }
    selectRange() {
        this.clearSelection();
        if (this.dragEnd + 1 < this.dragStart) {
            this.daysEl
                .slice(this.dragEnd, this.dragStart + 1)
                .forEach((cell) => this._renderer.setStyle(cell, 'background-color', '#fafafa'));
        }
        else {
            this.daysEl
                .slice(this.dragStart, this.dragEnd + 1)
                .forEach((cell) => this._renderer.setStyle(cell, 'background-color', '#fafafa'));
        }
    }
    clearSelection() {
        this.daysEl.forEach((cell) => this._renderer.removeStyle(cell, 'background-color'));
    }
    convertDateTo12hFormat(date) {
        return convertDateTo12h(date);
    }
    _generateDayView() {
        const dates = [];
        const month = getMonth(this.activeDate);
        const previousMonth = getMonth(addMonths(this.activeDate, -1));
        const nextMonth = getMonth(addMonths(this.activeDate, 1));
        const year = getYear(this.activeDate);
        const firstDay = getFirstDayOfWeek(year, month, this.mondayFirst);
        const daysInMonth = getDaysInMonth(this.activeDate);
        const daysInPreviousMonth = getDaysInMonth(addMonths(this.activeDate, -1));
        const daysInWeek = 7;
        let dayNumber = 1;
        let isCurrentMonth = false;
        for (let i = 1; i < daysInWeek; i++) {
            const week = [];
            if (i === 1) {
                // First week
                const previousMonthDay = daysInPreviousMonth - firstDay + 1;
                // Previous month
                for (let j = previousMonthDay; j <= daysInPreviousMonth; j++) {
                    const date = createDate(year, previousMonth, j, 0, 0, 0, 0);
                    week.push({
                        date,
                        currentMonth: isCurrentMonth,
                        isToday: isSameDate(date, getToday()),
                        dayNumber: getDate(date),
                        event: getEvents(this.events, startOfDay(date), endOfDay(date), false),
                    });
                }
                isCurrentMonth = true;
                // Current month
                const daysLeft = daysInWeek - week.length;
                for (let j = 0; j < daysLeft; j++) {
                    const date = createDate(year, month, dayNumber, 0, 0, 0, 0);
                    week.push({
                        date,
                        currentMonth: isCurrentMonth,
                        isToday: isSameDate(date, getToday()),
                        dayNumber: getDate(date),
                        event: getEvents(this.events, startOfDay(date), endOfDay(date), false),
                    });
                    dayNumber++;
                }
            }
            else {
                // Rest of the weeks
                for (let j = 1; j < 8; j++) {
                    if (dayNumber > daysInMonth) {
                        // Next month
                        dayNumber = 1;
                        isCurrentMonth = false;
                    }
                    const date = createDate(year, isCurrentMonth ? month : nextMonth, dayNumber, 0, 0, 0, 0);
                    week.push({
                        date,
                        currentMonth: isCurrentMonth,
                        isToday: isSameDate(date, getToday()),
                        dayNumber: getDate(date),
                        event: getEvents(this.events, startOfDay(date), endOfDay(date), false),
                    });
                    dayNumber++;
                }
            }
            dates.push(week);
        }
        return dates;
    }
    _getWeekdays() {
        const startDay = this.mondayFirst ? 1 : 0;
        const weekdays = this.options.weekdays;
        const sortedWeekdays = weekdays.slice(startDay).concat(weekdays.slice(0, startDay));
        return startDay !== 0 ? sortedWeekdays : weekdays;
    }
}
MdbCalendarMonthViewComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.2.3", ngImport: i0, type: MdbCalendarMonthViewComponent, deps: [{ token: i0.Renderer2 }], target: i0.ɵɵFactoryTarget.Component });
MdbCalendarMonthViewComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.2.3", type: MdbCalendarMonthViewComponent, selector: "mdb-month-view-calendar", inputs: { readonly: "readonly", options: "options", mondayFirst: "mondayFirst", twelveHours: "twelveHours", activeDate: "activeDate", events: "events" }, outputs: { dayClicked: "dayClicked", eventClicked: "eventClicked", eventDragged: "eventDragged" }, viewQueries: [{ propertyName: "days", predicate: ["dayEl"], descendants: true }], ngImport: i0, template: "<table class=\"month\">\n  <thead>\n    <tr>\n      <th *ngFor=\"let weekDay of weekdays\">\n        {{ weekDay }}\n      </th>\n    </tr>\n  </thead>\n  <tbody cdkDropList>\n    <tr *ngFor=\"let date of dates\">\n      <td\n        #dayEl\n        *ngFor=\"let day of date; let dayIndex = index\"\n        [ngClass]=\"{'disabled': !day.currentMonth, 'today': day.isToday}\"\n        (click)=\"onDayClick(day)\"\n        (mousedown)=\"onMouseDown($event, day)\"\n        (mouseup)=\"onMouseUp($event, day)\" \n        (mouseenter)=\"onMouseMove($event)\"\n        (dragenter)=\"onDragEnter($event, day)\"\n        (dragover)=\"onDragOver($event)\"\n        (dragleave)=\"onDragLeave($event)\"\n      >\n        <div class=\"day-field\">{{ day.dayNumber }}</div>\n        <div class=\"events-wrapper\">\n          <ng-container *ngFor=\"let event of day.event; let i = index\">\n            <ng-container *ngIf=\"event.order > i + 1 && i === 0\">\n              <div \n                class=\"fake-event\"\n                *ngFor=\"let fakeEvent of [].constructor(event.order - 1); let index = index\"\n                [ngStyle]=\"{ order: index + 1 }\"\n              >\n                &nbsp;\n              </div>\n            </ng-container>\n            <ng-container *ngIf=\"event.order > i + 1 && i !== 0\">\n              <div \n                class=\"fake-event\"\n                *ngFor=\"let fakeEvent of [].constructor(event.order - 1 - day.event[i -1].order); let index = index\"\n                [ngStyle]=\"{ order: event.order - day.event[i - 1].order + 1 }\"\n              >\n                &nbsp;\n              </div>\n            </ng-container>\n            <div \n              draggable=\"true\"\n              *ngIf=\"event.allDay || event.longEvent\" \n              class=\"event bg-{{event.color.background}}\"\n              [ngClass]=\"{'event-long': !event.eventStart, 'event-readonly': readonly, 'active' : hoveredEventId === event.id, 'dragging' : draggedEventId === event.id}\"\n              [ngStyle]=\"{ color: event.color.foreground, order: event.order }\"\n              id=\"{{i === 0 ? event.id : ''}}\"\n              html=\"true\"\n              mdbTooltip=\"\n                <h6><strong>{{event.summary}}</strong></h6>\n                <p><small><em>{{event.description}}</em></small></p>\n                <p class='me-0'><small>\n                  <i class='fas fa-calendar-alt pe-1'></i>\n                  {{ twelveHours ? convertDateTo12hFormat(event.startData.string) : event.startData.string}}\n                  - \n                  {{twelveHours ? convertDateTo12hFormat(event.endData.string) : event.endData.string }}\n                </small></p>\n              \"\n              [offset]=15\n              (click)=\"onEventClick(event); $event.stopPropagation()\"\n              (dragstart)=\"onEventDragStart(event)\"\n              (dragend)=\"onEventDragEnd(event)\"\n              (mouseenter)=\"onMouseEnter(event)\"\n              (mouseleave)=\"onMouseLeave()\"\n            >\n              {{ event.eventStart || dayIndex === 0 ? event.summary : '&nbsp;' }}\n            </div>\n            <div \n              draggable=\"true\"\n              *ngIf=\"!event.allDay && !event.longEvent\"  \n              class=\"event event-short text-{{event.color.background}}\"\n              [ngClass]=\"{'event-readonly': readonly, 'active' : hoveredEventId === event.id, 'dragging' : draggedEventId === event.id}\"\n              [ngStyle]=\"{ order: event.order }\"\n              id=\"{{i === 0 ? event.id : ''}}\"\n              html=\"true\"\n              mdbTooltip=\"\n                <h6><strong>{{event.summary}}</strong></h6>\n                <p><small><em>{{event.description}}</em></small></p>\n                <p class='me-0'><small>\n                  <i class='fas fa-calendar-alt pe-1'></i>\n                  {{ twelveHours ? convertDateTo12hFormat(event.startData.string) : event.startData.string}}\n                   - \n                  {{twelveHours ? convertDateTo12hFormat(event.endData.string) : event.endData.string }}\n                </small></p>\n              \"\n              [offset]=15\n              (click)=\"onEventClick(event); $event.stopPropagation()\"\n              (dragstart)=\"onEventDragStart(event)\"\n              (dragend)=\"onEventDragEnd(event)\"\n              (mouseenter)=\"onMouseEnter(event)\"\n              (mouseleave)=\"onMouseLeave()\"\n            >\n              <i class=\"fas fa-circle pe-1 event-circle\"></i>\n              {{ event.summary }}\n            </div>\n          </ng-container>\n        </div>\n      </td>\n    </tr>\n  </tbody>\n</table>", directives: [{ type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i1.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }, { type: i2.MdbTooltipDirective, selector: "[mdbTooltip]", inputs: ["mdbTooltip", "tooltipDisabled", "placement", "html", "animation", "trigger", "delayShow", "delayHide", "offset"], outputs: ["tooltipShow", "tooltipShown", "tooltipHide", "tooltipHidden"], exportAs: ["mdbTooltip"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.2.3", ngImport: i0, type: MdbCalendarMonthViewComponent, decorators: [{
            type: Component,
            args: [{ selector: 'mdb-month-view-calendar', styles: [], template: "<table class=\"month\">\n  <thead>\n    <tr>\n      <th *ngFor=\"let weekDay of weekdays\">\n        {{ weekDay }}\n      </th>\n    </tr>\n  </thead>\n  <tbody cdkDropList>\n    <tr *ngFor=\"let date of dates\">\n      <td\n        #dayEl\n        *ngFor=\"let day of date; let dayIndex = index\"\n        [ngClass]=\"{'disabled': !day.currentMonth, 'today': day.isToday}\"\n        (click)=\"onDayClick(day)\"\n        (mousedown)=\"onMouseDown($event, day)\"\n        (mouseup)=\"onMouseUp($event, day)\" \n        (mouseenter)=\"onMouseMove($event)\"\n        (dragenter)=\"onDragEnter($event, day)\"\n        (dragover)=\"onDragOver($event)\"\n        (dragleave)=\"onDragLeave($event)\"\n      >\n        <div class=\"day-field\">{{ day.dayNumber }}</div>\n        <div class=\"events-wrapper\">\n          <ng-container *ngFor=\"let event of day.event; let i = index\">\n            <ng-container *ngIf=\"event.order > i + 1 && i === 0\">\n              <div \n                class=\"fake-event\"\n                *ngFor=\"let fakeEvent of [].constructor(event.order - 1); let index = index\"\n                [ngStyle]=\"{ order: index + 1 }\"\n              >\n                &nbsp;\n              </div>\n            </ng-container>\n            <ng-container *ngIf=\"event.order > i + 1 && i !== 0\">\n              <div \n                class=\"fake-event\"\n                *ngFor=\"let fakeEvent of [].constructor(event.order - 1 - day.event[i -1].order); let index = index\"\n                [ngStyle]=\"{ order: event.order - day.event[i - 1].order + 1 }\"\n              >\n                &nbsp;\n              </div>\n            </ng-container>\n            <div \n              draggable=\"true\"\n              *ngIf=\"event.allDay || event.longEvent\" \n              class=\"event bg-{{event.color.background}}\"\n              [ngClass]=\"{'event-long': !event.eventStart, 'event-readonly': readonly, 'active' : hoveredEventId === event.id, 'dragging' : draggedEventId === event.id}\"\n              [ngStyle]=\"{ color: event.color.foreground, order: event.order }\"\n              id=\"{{i === 0 ? event.id : ''}}\"\n              html=\"true\"\n              mdbTooltip=\"\n                <h6><strong>{{event.summary}}</strong></h6>\n                <p><small><em>{{event.description}}</em></small></p>\n                <p class='me-0'><small>\n                  <i class='fas fa-calendar-alt pe-1'></i>\n                  {{ twelveHours ? convertDateTo12hFormat(event.startData.string) : event.startData.string}}\n                  - \n                  {{twelveHours ? convertDateTo12hFormat(event.endData.string) : event.endData.string }}\n                </small></p>\n              \"\n              [offset]=15\n              (click)=\"onEventClick(event); $event.stopPropagation()\"\n              (dragstart)=\"onEventDragStart(event)\"\n              (dragend)=\"onEventDragEnd(event)\"\n              (mouseenter)=\"onMouseEnter(event)\"\n              (mouseleave)=\"onMouseLeave()\"\n            >\n              {{ event.eventStart || dayIndex === 0 ? event.summary : '&nbsp;' }}\n            </div>\n            <div \n              draggable=\"true\"\n              *ngIf=\"!event.allDay && !event.longEvent\"  \n              class=\"event event-short text-{{event.color.background}}\"\n              [ngClass]=\"{'event-readonly': readonly, 'active' : hoveredEventId === event.id, 'dragging' : draggedEventId === event.id}\"\n              [ngStyle]=\"{ order: event.order }\"\n              id=\"{{i === 0 ? event.id : ''}}\"\n              html=\"true\"\n              mdbTooltip=\"\n                <h6><strong>{{event.summary}}</strong></h6>\n                <p><small><em>{{event.description}}</em></small></p>\n                <p class='me-0'><small>\n                  <i class='fas fa-calendar-alt pe-1'></i>\n                  {{ twelveHours ? convertDateTo12hFormat(event.startData.string) : event.startData.string}}\n                   - \n                  {{twelveHours ? convertDateTo12hFormat(event.endData.string) : event.endData.string }}\n                </small></p>\n              \"\n              [offset]=15\n              (click)=\"onEventClick(event); $event.stopPropagation()\"\n              (dragstart)=\"onEventDragStart(event)\"\n              (dragend)=\"onEventDragEnd(event)\"\n              (mouseenter)=\"onMouseEnter(event)\"\n              (mouseleave)=\"onMouseLeave()\"\n            >\n              <i class=\"fas fa-circle pe-1 event-circle\"></i>\n              {{ event.summary }}\n            </div>\n          </ng-container>\n        </div>\n      </td>\n    </tr>\n  </tbody>\n</table>" }]
        }], ctorParameters: function () { return [{ type: i0.Renderer2 }]; }, propDecorators: { days: [{
                type: ViewChildren,
                args: ['dayEl']
            }], readonly: [{
                type: Input
            }], options: [{
                type: Input
            }], mondayFirst: [{
                type: Input
            }], twelveHours: [{
                type: Input
            }], activeDate: [{
                type: Input
            }], events: [{
                type: Input
            }], dayClicked: [{
                type: Output
            }], eventClicked: [{
                type: Output
            }], eventDragged: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsZW5kYXItbW9udGgtdmlldy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9tZGItYW5ndWxhci1jYWxlbmRhci9zcmMvbGliL2NhbGVuZGFyLW1vbnRoLXZpZXcuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vcHJvamVjdHMvbWRiLWFuZ3VsYXItY2FsZW5kYXIvc3JjL2xpYi9jYWxlbmRhci1tb250aC12aWV3LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCxZQUFZLEVBQ1osU0FBUyxFQUNULEtBQUssRUFFTCxNQUFNLEVBRU4sWUFBWSxHQUliLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFDTCxpQkFBaUIsRUFDakIsY0FBYyxFQUNkLFFBQVEsRUFDUixTQUFTLEVBQ1QsVUFBVSxFQUNWLFVBQVUsRUFDVixRQUFRLEVBQ1IsT0FBTyxFQUNQLE9BQU8sRUFDUCxRQUFRLEVBQ1IsVUFBVSxFQUNWLGFBQWEsRUFDYixTQUFTLEVBQ1QsZ0JBQWdCLEVBQ2hCLE9BQU8sRUFDUCxnQkFBZ0IsR0FDakIsTUFBTSxrQkFBa0IsQ0FBQzs7OztBQVExQixNQUFNLE9BQU8sNkJBQTZCO0lBNkN4QyxZQUFvQixTQUFvQjtRQUFwQixjQUFTLEdBQVQsU0FBUyxDQUFXO1FBbkI5QixlQUFVLEdBQW1DLElBQUksWUFBWSxFQUFFLENBQUM7UUFDaEUsaUJBQVksR0FBbUMsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNsRSxpQkFBWSxHQUFzQixJQUFJLFlBQVksRUFBRSxDQUFDO1FBRS9ELFVBQUssR0FBRyxFQUFFLENBQUM7UUFHWCxlQUFVLEdBQUcsS0FBSyxDQUFDO0lBWXdCLENBQUM7SUF0QzVDLElBQ0ksVUFBVTtRQUNaLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQztJQUMxQixDQUFDO0lBQ0QsSUFBSSxVQUFVLENBQUMsSUFBVTtRQUN2QixJQUFJ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WUFDRCxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ2xCO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0lBRU8sWUFBWTtRQUNsQixNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMxQyxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQztRQUN2QyxNQUFNLGNBQWMsR0FBRyxRQUFRLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDO1FBRXBGLE9BQU8sUUFBUSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7SUFDcEQsQ0FBQzs7MEhBMVFVLDZCQUE2Qjs4R0FBN0IsNkJBQTZCLDhZQ3JDMUMsMmtKQXVHUTsyRkRsRUssNkJBQTZCO2tCQU56QyxTQUFTOytCQUVFLHlCQUF5QixVQUUzQixFQUFFO2dHQUdhLElBQUk7c0JBQTFCLFlBQVk7dUJBQUMsT0FBTztnQkFFWixRQUFRO3NCQUFoQixLQUFLO2dCQUNHLE9BQU87c0JBQWYsS0FBSztnQkFDRyxXQUFXO3NCQUFuQixLQUFLO2dCQUNHLFdBQVc7c0JBQW5CLEtBQUs7Z0JBRUYsVUFBVTtzQkFEYixLQUFLO2dCQVdGLE1BQU07c0JBRFQsS0FBSztnQkFTSSxVQUFVO3NCQUFuQixNQUFNO2dCQUNHLFlBQVk7c0JBQXJCLE1BQU07Z0JBQ0csWUFBWTtzQkFBckIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEV2ZW50RW1pdHRlcixcbiAgQ29tcG9uZW50LFxuICBJbnB1dCxcbiAgT25Jbml0LFxuICBPdXRwdXQsXG4gIEVsZW1lbnRSZWYsXG4gIFZpZXdDaGlsZHJlbixcbiAgUXVlcnlMaXN0LFxuICBSZW5kZXJlcjIsXG4gIEFmdGVyVmlld0luaXQsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtcbiAgZ2V0Rmlyc3REYXlPZldlZWssXG4gIGdldERheXNJbk1vbnRoLFxuICBnZXRNb250aCxcbiAgYWRkTW9udGhzLFxuICBjcmVhdGVEYXRlLFxuICBpc1NhbWVEYXRlLFxuICBnZXRUb2RheSxcbiAgZ2V0RGF0ZSxcbiAgZ2V0WWVhcixcbiAgZW5kT2ZEYXksXG4gIHN0YXJ0T2ZEYXksXG4gIGdlbmVyYXRlRXZlbnQsXG4gIGdldEV2ZW50cyxcbiAgZGlmZmVyZW5jZUluRGF5cyxcbiAgYWRkRGF5cyxcbiAgY29udmVydERhdGVUbzEyaCxcbn0gZnJvbSAnLi9jYWxlbmRhci51dGlscyc7XG5pbXBvcnQgeyBNZGJDYWxlbmRhckV2ZW50IH0gZnJvbSAnLi9jYWxlbmRhci5ldmVudC5pbnRlcmZhY2UnO1xuQENvbXBvbmVudCh7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvY29tcG9uZW50LXNlbGVjdG9yXG4gIHNlbGVjdG9yOiAnbWRiLW1vbnRoLXZpZXctY2FsZW5kYXInLFxuICB0ZW1wbGF0ZVVybDogJy4vY2FsZW5kYXItbW9udGgtdmlldy5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlczogW10sXG59KVxuZXhwb3J0IGNsYXNzIE1kYkNhbGVuZGFyTW9udGhWaWV3Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0IHtcbiAgQFZpZXdDaGlsZHJlbignZGF5RWwnKSBkYXlzOiBRdWVyeUxpc3Q8RWxlbWVudFJlZj47XG5cbiAgQElucHV0KCkgcmVhZG9ubHk6IGJvb2xlYW47XG4gIEBJbnB1dCgpIG9wdGlvbnM6IGFueTtcbiAgQElucHV0KCkgbW9uZGF5Rmlyc3Q6IGJvb2xlYW47XG4gIEBJbnB1dCgpIHR3ZWx2ZUhvdXJzOiBib29sZWFuO1xuICBASW5wdXQoKVxuICBnZXQgYWN0aXZlRGF0ZSgpOiBEYXRlIHtcbiAgICByZXR1cm4gdGhpcy5fYWN0aXZlRGF0ZTtcbiAgfVxuICBzZXQgYWN0aXZlRGF0ZShkYXRlOiBEYXRlKSB7XG4gICAgdGhpcy5fYWN0aXZlRGF0ZSA9IGRhdGU7XG4gICAgdGhpcy5kYXRlcyA9IHRoaXMuX2dlbmVyYXRlRGF5VmlldygpO1xuICB9XG4gIHByaXZhdGUgX2FjdGl2ZURhdGU6IERhdGU7XG5cbiAgQElucHV0KClcbiAgZ2V0IGV2ZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5fZXZlbnRzO1xuICB9XG4gIHNldCBldmVudHMoZXZlbnRzOiBNZGJDYWxlbmRhckV2ZW50W10pIHtcbiAgICB0aGlzLl9ldmVudHMgPSBldmVudHM7XG4gICAgdGhpcy5kYXRlcyA9IHRoaXMuX2dlbmVyYXRlRGF5VmlldygpO1xuICB9XG4gIHByaXZhdGUgX2V2ZW50czogTWRiQ2FsZW5kYXJFdmVudFtdO1xuICBAT3V0cHV0KCkgZGF5Q2xpY2tlZDogRXZlbnRFbWl0dGVyPE1kYkNhbGVuZGFyRXZlbnQ+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBAT3V0cHV0KCkgZXZlbnRDbGlja2VkOiBFdmVudEVtaXR0ZXI8TWRiQ2FsZW5kYXJFdmVudD4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBPdXRwdXQoKSBldmVudERyYWdnZWQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gIGRhdGVzID0gW107XG4gIGRheXNFbDtcbiAgd2Vla2RheXM6IHN0cmluZ1tdO1xuICBpc0RyYWdnaW5nID0gZmFsc2U7XG5cbiAgZHJhZ1N0YXJ0OiBhbnk7XG4gIGRyYWdFbmQ6IGFueTtcblxuICBzZWxlY3Rpb25TdGFydERheTogRGF0ZTtcbiAgc2VsZWN0aW9uRW5kRGF5OiBEYXRlO1xuXG4gIGRyYWdUYXJnZXREYXk7XG4gIGhvdmVyZWRFdmVudElkO1xuICBkcmFnZ2VkRXZlbnRJZDtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIF9yZW5kZXJlcjogUmVuZGVyZXIyKSB7fVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMud2Vla2RheXMgPSB0aGlzLl9nZXRXZWVrZGF5cygpO1xuICAgIHRoaXMuZGF0ZXMgPSB0aGlzLl9nZW5lcmF0ZURheVZpZXcoKTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICB0aGlzLmRheXNFbCA9IHRoaXMuZGF5cy50b0FycmF5KCkubWFwKChlbDogRWxlbWVudFJlZikgPT4gZWwubmF0aXZlRWxlbWVudCk7XG4gIH1cblxuICBvbkV2ZW50Q2xpY2soZXZlbnQ6IE1kYkNhbGVuZGFyRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5yZWFkb25seSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZXZlbnRDbGlja2VkLmVtaXQoZXZlbnQpO1xuICB9XG5cbiAgb25EYXlDbGljayhkYXk6IGFueSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnJlYWRvbmx5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgbmV3Q2FsZW5kYXJFdmVudCA9IGdlbmVyYXRlRXZlbnQoZGF5LmRhdGUpO1xuICAgIHRoaXMuZGF5Q2xpY2tlZC5lbWl0KG5ld0NhbGVuZGFyRXZlbnQpO1xuICB9XG5cbiAgb25Nb3VzZURvd24oZXZlbnQ6IE1vdXNlRXZlbnQsIGRheSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnJlYWRvbmx5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTtcbiAgICB0aGlzLmRyYWdTdGFydCA9IHRoaXMuZGF5c0VsLmluZGV4T2YoZXZlbnQudGFyZ2V0KTtcbiAgICB0aGlzLnNlbGVjdGlvblN0YXJ0RGF5ID0gZGF5LmRhdGU7XG4gIH1cblxuICBvbk1vdXNlVXAoZXZlbnQ6IE1vdXNlRXZlbnQsIGRheSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnJlYWRvbmx5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5pc0RyYWdnaW5nID0gZmFsc2U7XG4gICAgdGhpcy5kcmFnRW5kID0gdGhpcy5kYXlzRWwuaW5kZXhPZihldmVudC50YXJnZXQpO1xuXG4gICAgaWYgKHRoaXMuZHJhZ0VuZCAhPT0gMCkge1xuICAgICAgdGhpcy5zZWxlY3RSYW5nZSgpO1xuICAgIH1cblxuICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICB0aGlzLnNlbGVjdGlvbkVuZERheSA9IGRheS5kYXRlO1xuXG4gICAgaWYgKHRoaXMuc2VsZWN0aW9uU3RhcnREYXkgPT09IHRoaXMuc2VsZWN0aW9uRW5kRGF5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgbmV3Q2FsZW5kYXJFdmVudCA9IGdlbmVyYXRlRXZlbnQodGhpcy5zZWxlY3Rpb25TdGFydERheSwgdGhpcy5zZWxlY3Rpb25FbmREYXkpO1xuICAgIHRoaXMuZGF5Q2xpY2tlZC5lbWl0KG5ld0NhbGVuZGFyRXZlbnQpO1xuICB9XG5cbiAgb25Nb3VzZU1vdmUoZXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5yZWFkb25seSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYgKHRoaXMuaXNEcmFnZ2luZykge1xuICAgICAgdGhpcy5kcmFnRW5kID0gdGhpcy5kYXlzRWwuaW5kZXhPZihldmVudC50YXJnZXQpO1xuICAgICAgdGhpcy5zZWxlY3RSYW5nZSgpO1xuICAgIH1cbiAgfVxuXG4gIG9uRXZlbnREcmFnU3RhcnQoY2FsZW5kYXJFdmVudDogTWRiQ2FsZW5kYXJFdmVudCk6IHZvaWQge1xuICAgIHRoaXMuZHJhZ2dlZEV2ZW50SWQgPSBjYWxlbmRhckV2ZW50LmlkO1xuICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgfVxuXG4gIG9uRXZlbnREcmFnRW5kKGNhbGVuZGFyRXZlbnQ6IE1kYkNhbGVuZGFyRXZlbnQpOiB2b2lkIHtcbiAgICB0aGlzLmRyYWdnZWRFdmVudElkID0gJyc7XG4gICAgdGhpcy5ob3ZlcmVkRXZlbnRJZCA9ICcnO1xuXG4gICAgY29uc3QgZGF5c0RpZmZlcmVuY2UgPSBkaWZmZXJlbmNlSW5EYXlzKFxuICAgICAgY2FsZW5kYXJFdmVudC5zdGFydERhdGUgYXMgRGF0ZSxcbiAgICAgIHRoaXMuZHJhZ1RhcmdldERheS5kYXRlXG4gICAgKTtcbiAgICBjb25zdCBuZXdTdGFydERhdGUgPSBhZGREYXlzKGNhbGVuZGFyRXZlbnQuc3RhcnREYXRlIGFzIERhdGUsIGRheXNEaWZmZXJlbmNlKTtcbiAgICBjb25zdCBuZXdFbmREYXRlID0gYWRkRGF5cyhjYWxlbmRhckV2ZW50LmVuZERhdGUgYXMgRGF0ZSwgZGF5c0RpZmZlcmVuY2UpO1xuXG4gICAgY29uc3QgbmV3RXZlbnQgPSB7XG4gICAgICAuLi5jYWxlbmRhckV2ZW50LFxuICAgICAgc3RhcnREYXRlOiBuZXdTdGFydERhdGUsXG4gICAgICBlbmREYXRlOiBuZXdFbmREYXRlLFxuICAgICAgb3JkZXI6ICcnLFxuICAgIH07XG5cbiAgICB0aGlzLmV2ZW50RHJhZ2dlZC5lbWl0KG5ld0V2ZW50KTtcbiAgfVxuXG4gIG9uRHJhZ0VudGVyKGV2ZW50OiBEcmFnRXZlbnQsIGRheTogYW55KTogdm9pZCB7XG4gICAgdGhpcy5fcmVuZGVyZXIuYWRkQ2xhc3MoZXZlbnQudGFyZ2V0LCAnZHJhZ2VudGVyJyk7XG4gICAgdGhpcy5kcmFnVGFyZ2V0RGF5ID0gZGF5O1xuICB9XG5cbiAgb25EcmFnTGVhdmUoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xuICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNsYXNzKGV2ZW50LnRhcmdldCwgJ2RyYWdlbnRlcicpO1xuICB9XG5cbiAgb25EcmFnT3ZlcihldmVudDogRHJhZ0V2ZW50KTogYm9vbGVhbiB7XG4gICAgaWYgKGV2ZW50LnByZXZlbnREZWZhdWx0KSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBvbk1vdXNlRW50ZXIoZXZlbnQ6IE1kYkNhbGVuZGFyRXZlbnQpOiB2b2lkIHtcbiAgICB0aGlzLmhvdmVyZWRFdmVudElkID0gZXZlbnQuaWQ7XG4gIH1cblxuICBvbk1vdXNlTGVhdmUoKTogdm9pZCB7XG4gICAgdGhpcy5ob3ZlcmVkRXZlbnRJZCA9ICcnO1xuICB9XG5cbiAgc2VsZWN0UmFuZ2UoKTogdm9pZCB7XG4gICAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xuICAgIGlmICh0aGlzLmRyYWdFbmQgKyAxIDwgdGhpcy5kcmFnU3RhcnQpIHtcbiAgICAgIHRoaXMuZGF5c0VsXG4gICAgICAgIC5zbGljZSh0aGlzLmRyYWdFbmQsIHRoaXMuZHJhZ1N0YXJ0ICsgMSlcbiAgICAgICAgLmZvckVhY2goKGNlbGwpID0+IHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGNlbGwsICdiYWNrZ3JvdW5kLWNvbG9yJywgJyNmYWZhZmEnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGF5c0VsXG4gICAgICAgIC5zbGljZSh0aGlzLmRyYWdTdGFydCwgdGhpcy5kcmFnRW5kICsgMSlcbiAgICAgICAgLmZvckVhY2goKGNlbGwpID0+IHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGNlbGwsICdiYWNrZ3JvdW5kLWNvbG9yJywgJyNmYWZhZmEnKSk7XG4gICAgfVxuICB9XG5cbiAgY2xlYXJTZWxlY3Rpb24oKTogdm9pZCB7XG4gICAgdGhpcy5kYXlzRWwuZm9yRWFjaCgoY2VsbCkgPT4gdGhpcy5fcmVuZGVyZXIucmVtb3ZlU3R5bGUoY2VsbCwgJ2JhY2tncm91bmQtY29sb3InKSk7XG4gIH1cblxuICBjb252ZXJ0RGF0ZVRvMTJoRm9ybWF0KGRhdGU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGNvbnZlcnREYXRlVG8xMmgoZGF0ZSk7XG4gIH1cblxuICBfZ2VuZXJhdGVEYXlWaWV3KCk6IGFueSB7XG4gICAgY29uc3QgZGF0ZXMgPSBbXTtcbiAgICBjb25zdCBtb250aCA9IGdldE1vbnRoKHRoaXMuYWN0aXZlRGF0ZSk7XG4gICAgY29uc3QgcHJldmlvdXNNb250aCA9IGdldE1vbnRoKGFkZE1vbnRocyh0aGlzLmFjdGl2ZURhdGUsIC0xKSk7XG4gICAgY29uc3QgbmV4dE1vbnRoID0gZ2V0TW9udGgoYWRkTW9udGhzKHRoaXMuYWN0aXZlRGF0ZSwgMSkpO1xuICAgIGNvbnN0IHllYXIgPSBnZXRZZWFyKHRoaXMuYWN0aXZlRGF0ZSk7XG4gICAgY29uc3QgZmlyc3REYXkgPSBnZXRGaXJzdERheU9mV2Vlayh5ZWFyLCBtb250aCwgdGhpcy5tb25kYXlGaXJzdCk7XG4gICAgY29uc3QgZGF5c0luTW9udGggPSBnZXREYXlzSW5Nb250aCh0aGlzLmFjdGl2ZURhdGUpO1xuICAgIGNvbnN0IGRheXNJblByZXZpb3VzTW9udGggPSBnZXREYXlzSW5Nb250aChhZGRNb250aHModGhpcy5hY3RpdmVEYXRlLCAtMSkpO1xuICAgIGNvbnN0IGRheXNJbldlZWsgPSA3O1xuXG4gICAgbGV0IGRheU51bWJlciA9IDE7XG4gICAgbGV0IGlzQ3VycmVudE1vbnRoID0gZmFsc2U7XG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCBkYXlzSW5XZWVrOyBpKyspIHtcbiAgICAgIGNvbnN0IHdlZWsgPSBbXTtcbiAgICAgIGlmIChpID09PSAxKSB7XG4gICAgICAgIC8vIEZpcnN0IHdlZWtcbiAgICAgICAgY29uc3QgcHJldmlvdXNNb250aERheSA9IGRheXNJblByZXZpb3VzTW9udGggLSBmaXJzdERheSArIDE7XG4gICAgICAgIC8vIFByZXZpb3VzIG1vbnRoXG4gICAgICAgIGZvciAobGV0IGogPSBwcmV2aW91c01vbnRoRGF5OyBqIDw9IGRheXNJblByZXZpb3VzTW9udGg7IGorKykge1xuICAgICAgICAgIGNvbnN0IGRhdGUgPSBjcmVhdGVEYXRlKHllYXIsIHByZXZpb3VzTW9udGgsIGosIDAsIDAsIDAsIDApO1xuXG4gICAgICAgICAgd2Vlay5wdXNoKHtcbiAgICAgICAgICAgIGRhdGUsXG4gICAgICAgICAgICBjdXJyZW50TW9udGg6IGlzQ3VycmVudE1vbnRoLFxuICAgICAgICAgICAgaXNUb2RheTogaXNTYW1lRGF0ZShkYXRlLCBnZXRUb2RheSgpKSxcbiAgICAgICAgICAgIGRheU51bWJlcjogZ2V0RGF0ZShkYXRlKSxcbiAgICAgICAgICAgIGV2ZW50OiBnZXRFdmVudHModGhpcy5ldmVudHMsIHN0YXJ0T2ZEYXkoZGF0ZSksIGVuZE9mRGF5KGRhdGUpLCBmYWxzZSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpc0N1cnJlbnRNb250aCA9IHRydWU7XG4gICAgICAgIC8vIEN1cnJlbnQgbW9udGhcbiAgICAgICAgY29uc3QgZGF5c0xlZnQgPSBkYXlzSW5XZWVrIC0gd2Vlay5sZW5ndGg7XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgZGF5c0xlZnQ7IGorKykge1xuICAgICAgICAgIGNvbnN0IGRhdGUgPSBjcmVhdGVEYXRlKHllYXIsIG1vbnRoLCBkYXlOdW1iZXIsIDAsIDAsIDAsIDApO1xuXG4gICAgICAgICAgd2Vlay5wdXNoKHtcbiAgICAgICAgICAgIGRhdGUsXG4gICAgICAgICAgICBjdXJyZW50TW9udGg6IGlzQ3VycmVudE1vbnRoLFxuICAgICAgICAgICAgaXNUb2RheTogaXNTYW1lRGF0ZShkYXRlLCBnZXRUb2RheSgpKSxcbiAgICAgICAgICAgIGRheU51bWJlcjogZ2V0RGF0ZShkYXRlKSxcbiAgICAgICAgICAgIGV2ZW50OiBnZXRFdmVudHModGhpcy5ldmVudHMsIHN0YXJ0T2ZEYXkoZGF0ZSksIGVuZE9mRGF5KGRhdGUpLCBmYWxzZSksXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZGF5TnVtYmVyKys7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFJlc3Qgb2YgdGhlIHdlZWtzXG4gICAgICAgIGZvciAobGV0IGogPSAxOyBqIDwgODsgaisrKSB7XG4gICAgICAgICAgaWYgKGRheU51bWJlciA+IGRheXNJbk1vbnRoKSB7XG4gICAgICAgICAgICAvLyBOZXh0IG1vbnRoXG4gICAgICAgICAgICBkYXlOdW1iZXIgPSAxO1xuICAgICAgICAgICAgaXNDdXJyZW50TW9udGggPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgZGF0ZSA9IGNyZWF0ZURhdGUoeWVhciwgaXNDdXJyZW50TW9udGggPyBtb250aCA6IG5leHRNb250aCwgZGF5TnVtYmVyLCAwLCAwLCAwLCAwKTtcblxuICAgICAgICAgIHdlZWsucHVzaCh7XG4gICAgICAgICAgICBkYXRlLFxuICAgICAgICAgICAgY3VycmVudE1vbnRoOiBpc0N1cnJlbnRNb250aCxcbiAgICAgICAgICAgIGlzVG9kYXk6IGlzU2FtZURhdGUoZGF0ZSwgZ2V0VG9kYXkoKSksXG4gICAgICAgICAgICBkYXlOdW1iZXI6IGdldERhdGUoZGF0ZSksXG4gICAgICAgICAgICBldmVudDogZ2V0RXZlbnRzKHRoaXMuZXZlbnRzLCBzdGFydE9mRGF5KGRhdGUpLCBlbmRPZkRheShkYXRlKSwgZmFsc2UpLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGRheU51bWJlcisrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBkYXRlcy5wdXNoKHdlZWspO1xuICAgIH1cbiAgICByZXR1cm4gZGF0ZXM7XG4gIH1cblxuICBwcml2YXRlIF9nZXRXZWVrZGF5cygpOiBzdHJpbmdbXSB7XG4gICAgY29uc3Qgc3RhcnREYXkgPSB0aGlzLm1vbmRheUZpcnN0ID8gMSA6IDA7XG4gICAgY29uc3Qgd2Vla2RheXMgPSB0aGlzLm9wdGlvbnMud2Vla2RheXM7XG4gICAgY29uc3Qgc29ydGVkV2Vla2RheXMgPSB3ZWVrZGF5cy5zbGljZShzdGFydERheSkuY29uY2F0KHdlZWtkYXlzLnNsaWNlKDAsIHN0YXJ0RGF5KSk7XG5cbiAgICByZXR1cm4gc3RhcnREYXkgIT09IDAgPyBzb3J0ZWRXZWVrZGF5cyA6IHdlZWtkYXlzO1xuICB9XG59XG4iLCI8dGFibGUgY2xhc3M9XCJtb250aFwiPlxuICA8dGhlYWQ+XG4gICAgPHRyPlxuICAgICAgPHRoICpuZ0Zvcj1cImxldCB3ZWVrRGF5IG9mIHdlZWtkYXlzXCI+XG4gICAgICAgIHt7IHdlZWtEYXkgfX1cbiAgICAgIDwvdGg+XG4gICAgPC90cj5cbiAgPC90aGVhZD5cbiAgPHRib2R5IGNka0Ryb3BMaXN0PlxuICAgIDx0ciAqbmdGb3I9XCJsZXQgZGF0ZSBvZiBkYXRlc1wiPlxuICAgICAgPHRkXG4gICAgICAgICNkYXlFbFxuICAgICAgICAqbmdGb3I9XCJsZXQgZGF5IG9mIGRhdGU7IGxldCBkYXlJbmRleCA9IGluZGV4XCJcbiAgICAgICAgW25nQ2xhc3NdPVwieydkaXNhYmxlZCc6ICFkYXkuY3VycmVudE1vbnRoLCAndG9kYXknOiBkYXkuaXNUb2RheX1cIlxuICAgICAgICAoY2xpY2spPVwib25EYXlDbGljayhkYXkpXCJcbiAgICAgICAgKG1vdXNlZG93bik9XCJvbk1vdXNlRG93bigkZXZlbnQsIGRheSlcIlxuICAgICAgICAobW91c2V1cCk9XCJvbk1vdXNlVXAoJGV2ZW50LCBkYXkpXCIgXG4gICAgICAgIChtb3VzZWVudGVyKT1cIm9uTW91c2VNb3ZlKCRldmVudClcIlxuICAgICAgICAoZHJhZ2VudGVyKT1cIm9uRHJhZ0VudGVyKCRldmVudCwgZGF5KVwiXG4gICAgICAgIChkcmFnb3Zlcik9XCJvbkRyYWdPdmVyKCRldmVudClcIlxuICAgICAgICAoZHJhZ2xlYXZlKT1cIm9uRHJhZ0xlYXZlKCRldmVudClcIlxuICAgICAgPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZGF5LWZpZWxkXCI+e3sgZGF5LmRheU51bWJlciB9fTwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZXZlbnRzLXdyYXBwZXJcIj5cbiAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBldmVudCBvZiBkYXkuZXZlbnQ7IGxldCBpID0gaW5kZXhcIj5cbiAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJldmVudC5vcmRlciA+IGkgKyAxICYmIGkgPT09IDBcIj5cbiAgICAgICAgICAgICAgPGRpdiBcbiAgICAgICAgICAgICAgICBjbGFzcz1cImZha2UtZXZlbnRcIlxuICAgICAgICAgICAgICAgICpuZ0Zvcj1cImxldCBmYWtlRXZlbnQgb2YgW10uY29uc3RydWN0b3IoZXZlbnQub3JkZXIgLSAxKTsgbGV0IGluZGV4ID0gaW5kZXhcIlxuICAgICAgICAgICAgICAgIFtuZ1N0eWxlXT1cInsgb3JkZXI6IGluZGV4ICsgMSB9XCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImV2ZW50Lm9yZGVyID4gaSArIDEgJiYgaSAhPT0gMFwiPlxuICAgICAgICAgICAgICA8ZGl2IFxuICAgICAgICAgICAgICAgIGNsYXNzPVwiZmFrZS1ldmVudFwiXG4gICAgICAgICAgICAgICAgKm5nRm9yPVwibGV0IGZha2VFdmVudCBvZiBbXS5jb25zdHJ1Y3RvcihldmVudC5vcmRlciAtIDEgLSBkYXkuZXZlbnRbaSAtMV0ub3JkZXIpOyBsZXQgaW5kZXggPSBpbmRleFwiXG4gICAgICAgICAgICAgICAgW25nU3R5bGVdPVwieyBvcmRlcjogZXZlbnQub3JkZXIgLSBkYXkuZXZlbnRbaSAtIDFdLm9yZGVyICsgMSB9XCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgPGRpdiBcbiAgICAgICAgICAgICAgZHJhZ2dhYmxlPVwidHJ1ZVwiXG4gICAgICAgICAgICAgICpuZ0lmPVwiZXZlbnQuYWxsRGF5IHx8IGV2ZW50LmxvbmdFdmVudFwiIFxuICAgICAgICAgICAgICBjbGFzcz1cImV2ZW50IGJnLXt7ZXZlbnQuY29sb3IuYmFja2dyb3VuZH19XCJcbiAgICAgICAgICAgICAgW25nQ2xhc3NdPVwieydldmVudC1sb25nJzogIWV2ZW50LmV2ZW50U3RhcnQsICdldmVudC1yZWFkb25seSc6IHJlYWRvbmx5LCAnYWN0aXZlJyA6IGhvdmVyZWRFdmVudElkID09PSBldmVudC5pZCwgJ2RyYWdnaW5nJyA6IGRyYWdnZWRFdmVudElkID09PSBldmVudC5pZH1cIlxuICAgICAgICAgICAgICBbbmdTdHlsZV09XCJ7IGNvbG9yOiBldmVudC5jb2xvci5mb3JlZ3JvdW5kLCBvcmRlcjogZXZlbnQub3JkZXIgfVwiXG4gICAgICAgICAgICAgIGlkPVwie3tpID09PSAwID8gZXZlbnQuaWQgOiAnJ319XCJcbiAgICAgICAgICAgICAgaHRtbD1cInRydWVcIlxuICAgICAgICAgICAgICBtZGJUb29sdGlwPVwiXG4gICAgICAgICAgICAgICAgPGg2PjxzdHJvbmc+e3tldmVudC5zdW1tYXJ5fX08L3N0cm9uZz48L2g2PlxuICAgICAgICAgICAgICAgIDxwPjxzbWFsbD48ZW0+e3tldmVudC5kZXNjcmlwdGlvbn19PC9lbT48L3NtYWxsPjwvcD5cbiAgICAgICAgICAgICAgICA8cCBjbGFzcz0nbWUtMCc+PHNtYWxsPlxuICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9J2ZhcyBmYS1jYWxlbmRhci1hbHQgcGUtMSc+PC9pPlxuICAgICAgICAgICAgICAgICAge3sgdHdlbHZlSG91cnMgPyBjb252ZXJ0RGF0ZVRvMTJoRm9ybWF0KGV2ZW50LnN0YXJ0RGF0YS5zdHJpbmcpIDogZXZlbnQuc3RhcnREYXRhLnN0cmluZ319XG4gICAgICAgICAgICAgICAgICAtIFxuICAgICAgICAgICAgICAgICAge3t0d2VsdmVIb3VycyA/IGNvbnZlcnREYXRlVG8xMmhGb3JtYXQoZXZlbnQuZW5kRGF0YS5zdHJpbmcpIDogZXZlbnQuZW5kRGF0YS5zdHJpbmcgfX1cbiAgICAgICAgICAgICAgICA8L3NtYWxsPjwvcD5cbiAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgW29mZnNldF09MTVcbiAgICAgICAgICAgICAgKGNsaWNrKT1cIm9uRXZlbnRDbGljayhldmVudCk7ICRldmVudC5zdG9wUHJvcGFnYXRpb24oKVwiXG4gICAgICAgICAgICAgIChkcmFnc3RhcnQpPVwib25FdmVudERyYWdTdGFydChldmVudClcIlxuICAgICAgICAgICAgICAoZHJhZ2VuZCk9XCJvbkV2ZW50RHJhZ0VuZChldmVudClcIlxuICAgICAgICAgICAgICAobW91c2VlbnRlcik9XCJvbk1vdXNlRW50ZXIoZXZlbnQpXCJcbiAgICAgICAgICAgICAgKG1vdXNlbGVhdmUpPVwib25Nb3VzZUxlYXZlKClcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7eyBldmVudC5ldmVudFN0YXJ0IHx8IGRheUluZGV4ID09PSAwID8gZXZlbnQuc3VtbWFyeSA6ICcmbmJzcDsnIH19XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgXG4gICAgICAgICAgICAgIGRyYWdnYWJsZT1cInRydWVcIlxuICAgICAgICAgICAgICAqbmdJZj1cIiFldmVudC5hbGxEYXkgJiYgIWV2ZW50LmxvbmdFdmVudFwiICBcbiAgICAgICAgICAgICAgY2xhc3M9XCJldmVudCBldmVudC1zaG9ydCB0ZXh0LXt7ZXZlbnQuY29sb3IuYmFja2dyb3VuZH19XCJcbiAgICAgICAgICAgICAgW25nQ2xhc3NdPVwieydldmVudC1yZWFkb25seSc6IHJlYWRvbmx5LCAnYWN0aXZlJyA6IGhvdmVyZWRFdmVudElkID09PSBldmVudC5pZCwgJ2RyYWdnaW5nJyA6IGRyYWdnZWRFdmVudElkID09PSBldmVudC5pZH1cIlxuICAgICAgICAgICAgICBbbmdTdHlsZV09XCJ7IG9yZGVyOiBldmVudC5vcmRlciB9XCJcbiAgICAgICAgICAgICAgaWQ9XCJ7e2kgPT09IDAgPyBldmVudC5pZCA6ICcnfX1cIlxuICAgICAgICAgICAgICBodG1sPVwidHJ1ZVwiXG4gICAgICAgICAgICAgIG1kYlRvb2x0aXA9XCJcbiAgICAgICAgICAgICAgICA8aDY+PHN0cm9uZz57e2V2ZW50LnN1bW1hcnl9fTwvc3Ryb25nPjwvaDY+XG4gICAgICAgICAgICAgICAgPHA+PHNtYWxsPjxlbT57e2V2ZW50LmRlc2NyaXB0aW9ufX08L2VtPjwvc21hbGw+PC9wPlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzPSdtZS0wJz48c21hbGw+XG4gICAgICAgICAgICAgICAgICA8aSBjbGFzcz0nZmFzIGZhLWNhbGVuZGFyLWFsdCBwZS0xJz48L2k+XG4gICAgICAgICAgICAgICAgICB7eyB0d2VsdmVIb3VycyA/IGNvbnZlcnREYXRlVG8xMmhGb3JtYXQoZXZlbnQuc3RhcnREYXRhLnN0cmluZykgOiBldmVudC5zdGFydERhdGEuc3RyaW5nfX1cbiAgICAgICAgICAgICAgICAgICAtIFxuICAgICAgICAgICAgICAgICAge3t0d2VsdmVIb3VycyA/IGNvbnZlcnREYXRlVG8xMmhGb3JtYXQoZXZlbnQuZW5kRGF0YS5zdHJpbmcpIDogZXZlbnQuZW5kRGF0YS5zdHJpbmcgfX1cbiAgICAgICAgICAgICAgICA8L3NtYWxsPjwvcD5cbiAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgW29mZnNldF09MTVcbiAgICAgICAgICAgICAgKGNsaWNrKT1cIm9uRXZlbnRDbGljayhldmVudCk7ICRldmVudC5zdG9wUHJvcGFnYXRpb24oKVwiXG4gICAgICAgICAgICAgIChkcmFnc3RhcnQpPVwib25FdmVudERyYWdTdGFydChldmVudClcIlxuICAgICAgICAgICAgICAoZHJhZ2VuZCk9XCJvbkV2ZW50RHJhZ0VuZChldmVudClcIlxuICAgICAgICAgICAgICAobW91c2VlbnRlcik9XCJvbk1vdXNlRW50ZXIoZXZlbnQpXCJcbiAgICAgICAgICAgICAgKG1vdXNlbGVhdmUpPVwib25Nb3VzZUxlYXZlKClcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhcyBmYS1jaXJjbGUgcGUtMSBldmVudC1jaXJjbGVcIj48L2k+XG4gICAgICAgICAgICAgIHt7IGV2ZW50LnN1bW1hcnkgfX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvdGQ+XG4gICAgPC90cj5cbiAgPC90Ym9keT5cbjwvdGFibGU+Il19