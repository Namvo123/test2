import { Component, Input, Output, EventEmitter, ViewChildren, } from '@angular/core';
import { convertDateTo12h, differenceInDays, differenceInHours, generateEvent, getEvents, addDays, addHours, addMinutes, endOfDay, getDate, getDayNumber, getMonth, getToday, getYear, isSameDate, startOfDay, } from './calendar.utils';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "mdb-angular-ui-kit/tooltip";
export class MdbCalendarWeekViewComponent {
    constructor(_renderer) {
        this._renderer = _renderer;
        this.dayClicked = new EventEmitter();
        this.eventClicked = new EventEmitter();
        this.eventDragged = new EventEmitter();
        this.isDragging = false;
        this.dayCells = [];
        this.columns = [];
    }
    get activeDate() {
        return this._activeDate;
    }
    set activeDate(date) {
        this._activeDate = date;
        this.weekView = this._generateWeekView();
    }
    get events() {
        return this._events;
    }
    set events(events) {
        if (!events) {
            return;
        }
        this._events = events;
        this.weekView = this._generateWeekView();
    }
    ngOnInit() {
        this.weekView = this._generateWeekView();
    }
    onEventClick(event) {
        if (this.readonly) {
            return;
        }
        this.eventClicked.emit(event);
    }
    ngAfterViewInit() {
        this.hoursEl = this.hours.toArray().map((el) => el.nativeElement);
        for (let i = 1; i <= 7; i++) {
            this.hoursEl.forEach((row) => {
                this.columns.push(row.children[i]);
            });
        }
    }
    onDayClick(day) {
        if (this.readonly) {
            return;
        }
        let startDate = addMinutes(new Date(day.date.getTime()), -59);
        let endDate = day.date;
        if (day.date.getHours() === 0) {
            startDate = startOfDay(day.date);
            endDate = '';
        }
        const newCalendarEvent = generateEvent(startDate, endDate);
        this.dayClicked.emit(newCalendarEvent);
    }
    onMouseDown(event, day) {
        if (this.readonly) {
            return;
        }
        this.isDragging = true;
        this.dragStart = this.columns.indexOf(event.target);
        this.selectionStartDay = day.date;
    }
    onMouseUp(event, day) {
        if (this.readonly) {
            return;
        }
        this.isDragging = false;
        this.dragEnd = this.columns.indexOf(event.target);
        if (this.dragEnd !== 0) {
            this.selectRange();
        }
        this.clearSelection();
        this.selectionEndDay = day.date;
        if (this.selectionStartDay === this.selectionEndDay) {
            return;
        }
        const newCalendarEvent = generateEvent(addMinutes(new Date(this.selectionStartDay.getTime()), -59), addMinutes(new Date(this.selectionEndDay.getTime()), -59));
        this.dayClicked.emit(newCalendarEvent);
    }
    onMouseMove(event) {
        if (this.readonly) {
            return;
        }
        event.preventDefault();
        if (this.isDragging) {
            this.dragEnd = this.columns.indexOf(event.target);
            this.selectRange();
        }
    }
    onEventDragStart(calendarEvent) {
        this.draggedEventId = calendarEvent.id;
        this.clearSelection();
    }
    onEventDragEnd(calendarEvent) {
        this.draggedEventId = '';
        this.hoveredEventId = '';
        const daysDifference = differenceInDays(startOfDay(new Date(calendarEvent.startDate)), addDays(this.dragTargetDay.date, -1));
        const newStartDate = addDays(calendarEvent.startDate, daysDifference);
        const newEndDate = addDays(calendarEvent.endDate, daysDifference);
        const newEvent = {
            ...calendarEvent,
            startDate: newStartDate,
            endDate: newEndDate,
            order: '',
        };
        this.eventDragged.emit(newEvent);
    }
    onHoursEventDragEnd(calendarEvent) {
        this.draggedEventId = '';
        this.hoveredEventId = '';
        const daysDifference = differenceInHours(calendarEvent.startDate, this.dragTargetDay.date);
        const newStartDate = addHours(calendarEvent.startDate, daysDifference);
        const newEndDate = addHours(calendarEvent.endDate, daysDifference);
        const newEvent = {
            ...calendarEvent,
            startDate: newStartDate,
            endDate: newEndDate,
            order: '',
        };
        this.eventDragged.emit(newEvent);
    }
    onDragEnter(event, day) {
        this._renderer.addClass(event.target, 'dragenter');
        this.dragTargetDay = day;
    }
    onDragLeave(event) {
        this._renderer.removeClass(event.target, 'dragenter');
    }
    onDragOver(event) {
        if (event.preventDefault) {
            event.preventDefault();
        }
        return false;
    }
    onMouseEnter(event) {
        this.hoveredEventId = event.id;
    }
    onMouseLeave() {
        this.hoveredEventId = '';
    }
    selectRange() {
        this.clearSelection();
        if (this.dragEnd + 1 < this.dragStart) {
            this.columns
                .slice(this.dragEnd, this.dragStart + 1)
                .forEach((cell) => this._renderer.setStyle(cell, 'background-color', '#fafafa'));
        }
        else {
            this.columns.slice(this.dragStart, this.dragEnd + 1).forEach((cell) => {
                this._renderer.setStyle(cell, 'background-color', '#fafafa');
            });
        }
    }
    convertDateTo12hFormat(date) {
        return convertDateTo12h(date);
    }
    clearSelection() {
        this.columns.forEach((cell) => this._renderer.removeStyle(cell, 'background-color'));
    }
    _generateWeekView() {
        const sundayIndex = this.mondayFirst ? 1 : 0;
        const firstDay = addDays(this.activeDate, -getDayNumber(this.activeDate) + sundayIndex);
        const lastDay = addDays(firstDay, 6);
        const period = {
            start: `${this.options.monthsShort[getMonth(firstDay)]} ${getDate(firstDay)}`,
            end: `${this.options.monthsShort[getMonth(lastDay)]} ${getDate(lastDay)}, ${getYear(lastDay)}`,
        };
        const allDayRow = [];
        const weekRows = [];
        let row = [];
        let date;
        let month;
        let day;
        let dayNumber;
        let startDate;
        let endDate;
        let dayStart;
        let dayEnd;
        for (let i = 0; i < 24; i++) {
            row = [];
            for (let j = 0; j < 7; j++) {
                date = addDays(firstDay, j);
                month = getMonth(date) + 1;
                day = this.options.weekdays[getDayNumber(date)];
                dayNumber = getDate(date);
                startDate = addHours(startOfDay(date), i);
                endDate = addMinutes(startDate, 59.99);
                dayStart = startOfDay(date);
                dayEnd = endOfDay(date);
                if (month < 10) {
                    month = '0' + month;
                }
                if (dayNumber < 10) {
                    dayNumber = '0' + dayNumber;
                }
                row.push({
                    date: startDate,
                    isToday: isSameDate(date, getToday()),
                    events: getEvents(this.events, startDate, endDate, true),
                });
                if (i === 1) {
                    allDayRow.push({
                        date: addDays(date, 1),
                        isToday: isSameDate(date, getToday()),
                        day: day,
                        dayNumber: dayNumber,
                        month: month,
                        events: getEvents(this.events, dayStart, dayEnd),
                    });
                }
            }
            weekRows.push({ row });
        }
        return { allDayRow, weekRows, period };
    }
}
MdbCalendarWeekViewComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.2.3", ngImport: i0, type: MdbCalendarWeekViewComponent, deps: [{ token: i0.Renderer2 }], target: i0.ɵɵFactoryTarget.Component });
MdbCalendarWeekViewComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.2.3", type: MdbCalendarWeekViewComponent, selector: "mdb-week-view-calendar", inputs: { readonly: "readonly", options: "options", mondayFirst: "mondayFirst", twelveHours: "twelveHours", activeDate: "activeDate", events: "events" }, outputs: { dayClicked: "dayClicked", eventClicked: "eventClicked", eventDragged: "eventDragged" }, viewQueries: [{ propertyName: "hours", predicate: ["hourEl"], descendants: true }], ngImport: i0, template: "<table>\n  <thead>\n    <tr>\n      <th></th>\n      <th *ngFor=\"let day of weekView.allDayRow\">\n        {{ day.day }} {{ day.dayNumber }}/{{ day.month }}\n      </th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr class=\"long-event-row\">\n      <th></th>\n      <td \n        *ngFor=\"let day of weekView.allDayRow; let dayIndex = index\"\n        [ngClass]=\"{'today': day.isToday}\"\n        (click)=\"onDayClick(day)\"\n        (mousedown)=\"onMouseDown($event, day)\"\n        (mouseup)=\"onMouseUp($event, day)\" \n        (mouseenter)=\"onMouseMove($event)\"\n        (dragenter)=\"onDragEnter($event, day)\"\n        (dragover)=\"onDragOver($event)\"\n        (dragleave)=\"onDragLeave($event)\"\n      >\n        <div class=\"events-wrapper\">\n          <ng-container *ngFor=\"let event of day.events; let i = index\">\n            <ng-container *ngIf=\"event.order > i + 1 && i === 0\">\n              <div \n                class=\"fake-event\"\n                *ngFor=\"let fakeEvent of [].constructor(event.order - 1); let index = index\"\n                [ngStyle]=\"{ order: index + 1 }\"\n              >\n                &nbsp;\n              </div>\n            </ng-container>\n            <ng-container *ngIf=\"event.order > i + 1 && i !== 0\">\n              <div \n                class=\"fake-event\"\n                *ngFor=\"let fakeEvent of [].constructor(event.order - 1 - day.events[i - 1].order); let index = index\"\n                [ngStyle]=\"{ order: event.order - day.events[i - 1].order + 1 }\"\n              >\n                &nbsp;\n              </div>\n            </ng-container>\n            <div \n              draggable=\"true\"\n              class=\"event bg-{{event.color.background}}\"\n              [ngClass]=\"{'event-long': !event.eventStart, 'event-readonly': readonly, 'active' : hoveredEventId === event.id, 'dragging' : draggedEventId === event.id}\"\n              [ngStyle]=\"{ color: event.color.foreground, order: event.order }\"\n              *ngIf=\"event.allDay || event.longEvent\"\n              id=\"{{i === 0 ? event.id : ''}}\"\n              html=\"true\"\n              mdbTooltip=\"\n                <h6><strong>{{event.summary}}</strong></h6>\n                <p><small><em>{{event.description}}</em></small></p>\n                <p class='me-0'><small>\n                  <i class='fas fa-calendar-alt pe-1'></i>\n                  {{ twelveHours ? convertDateTo12hFormat(event.startData.string) : event.startData.string}}\n                  - \n                  {{twelveHours ? convertDateTo12hFormat(event.endData.string) : event.endData.string }}\n                </small></p>\"\n              [offset]=15\n              (click)=\"onEventClick(event); $event.stopPropagation()\"\n              (dragstart)=\"onEventDragStart(event)\"\n              (dragend)=\"onEventDragEnd(event)\"\n              (mouseenter)=\"onMouseEnter(event)\"\n              (mouseleave)=\"onMouseLeave()\"\n            >    \n              {{ event.eventStart || dayIndex === 0 ? event.summary : '&nbsp;' }}\n            </div>\n          </ng-container>\n          <ng-container *ngFor=\"let event of day.events\">\n            <div\n              draggable=\"true\" \n              class=\"event event-short\"\n              *ngIf=\"!event.allDay && !event.longEvent\"\n              [ngClass]=\"{'event-readonly': readonly, 'active' : hoveredEventId === event.id, 'dragging' : draggedEventId === event.id}\"\n              [ngStyle]=\"{ order: event.order }\"\n              html=\"true\"\n              mdbTooltip=\"\n                <h6><strong>{{event.summary}}</strong></h6>\n                <p><small><em>{{event.description}}</em></small></p>\n                <p class='me-0'><small>\n                  <i class='fas fa-calendar-alt pe-1'></i>\n                  {{ twelveHours ? convertDateTo12hFormat(event.startData.string) : event.startData.string}}\n                  - \n                  {{twelveHours ? convertDateTo12hFormat(event.endData.string) : event.endData.string }}\n                </small></p>\"\n              [offset]=15\n              (click)=\"onEventClick(event); $event.stopPropagation()\"\n              (dragstart)=\"onEventDragStart(event)\"\n              (dragend)=\"onEventDragEnd(event)\"\n              (mouseenter)=\"onMouseEnter(event)\"\n              (mouseleave)=\"onMouseLeave()\"\n            >\n              <i class=\"fas fa-circle pe-1 event-circle text-{{ event.color.background}}\"></i>\n              {{ event.summary }}\n            </div>\n          </ng-container>\n        </div>\n      </td>\n    </tr>\n     \n    <tr #hourEl *ngFor=\"let row of weekView.weekRows; let i = index\">\n      <th class=\"hour-field\" *ngIf=\"twelveHours\">\n        {{ i === 0 ? '12' : i < 12 ? i : i - 12 === 0 ? '12' : i - 12 }}:00 {{ i < 12 ? 'am' : 'pm'}}\n      </th>\n      <th class=\"hour-field\" *ngIf=\"!twelveHours\">\n        {{ i }}:00 \n      </th>\n      <td *ngFor=\"let date of row.row\"\n        (click)=\"onDayClick(date)\"\n        (mousedown)=\"onMouseDown($event, date)\"\n        (mouseup)=\"onMouseUp($event, date)\" \n        (mouseenter)=\"onMouseMove($event)\"\n        (dragenter)=\"onDragEnter($event, date)\"\n        (dragover)=\"onDragOver($event)\"\n        (dragleave)=\"onDragLeave($event)\"\n      >\n        <div\n          draggable=\"true\"\n          class=\"event event-short\"\n          *ngFor=\"let event of date.events\"\n          [ngClass]=\"{'event-readonly': readonly, 'active' : hoveredEventId === event.id, 'dragging' : draggedEventId === event.id}\"\n          html=\"true\"\n          mdbTooltip=\"\n            <h6><strong>{{event.summary}}</strong></h6>\n            <p><small><em>{{event.description}}</em></small></p>\n            <p class='me-0'><small>\n              <i class='fas fa-calendar-alt pe-1'></i>\n              {{ twelveHours ? convertDateTo12hFormat(event.startData.string) : event.startData.string}}\n              - \n              {{twelveHours ? convertDateTo12hFormat(event.endData.string) : event.endData.string }}\n            </small></p>\"\n          [offset]=15\n          (click)=\"onEventClick(event); $event.stopPropagation()\"\n          (dragstart)=\"onEventDragStart(event)\"\n          (dragend)=\"onHoursEventDragEnd(event)\"\n          (mouseenter)=\"onMouseEnter(event)\"\n          (mouseleave)=\"onMouseLeave()\"\n        >\n          <i class=\"fas fa-circle event-circle pe-1 text-{{ event.color.background }}\"></i>\n          {{event.summary}}\n        </div>\n      </td>\n    </tr>\n  </tbody>\n</table>", directives: [{ type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i1.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }, { type: i2.MdbTooltipDirective, selector: "[mdbTooltip]", inputs: ["mdbTooltip", "tooltipDisabled", "placement", "html", "animation", "trigger", "delayShow", "delayHide", "offset"], outputs: ["tooltipShow", "tooltipShown", "tooltipHide", "tooltipHidden"], exportAs: ["mdbTooltip"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.2.3", ngImport: i0, type: MdbCalendarWeekViewComponent, decorators: [{
            type: Component,
            args: [{ selector: 'mdb-week-view-calendar', styles: [], template: "<table>\n  <thead>\n    <tr>\n      <th></th>\n      <th *ngFor=\"let day of weekView.allDayRow\">\n        {{ day.day }} {{ day.dayNumber }}/{{ day.month }}\n      </th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr class=\"long-event-row\">\n      <th></th>\n      <td \n        *ngFor=\"let day of weekView.allDayRow; let dayIndex = index\"\n        [ngClass]=\"{'today': day.isToday}\"\n        (click)=\"onDayClick(day)\"\n        (mousedown)=\"onMouseDown($event, day)\"\n        (mouseup)=\"onMouseUp($event, day)\" \n        (mouseenter)=\"onMouseMove($event)\"\n        (dragenter)=\"onDragEnter($event, day)\"\n        (dragover)=\"onDragOver($event)\"\n        (dragleave)=\"onDragLeave($event)\"\n      >\n        <div class=\"events-wrapper\">\n          <ng-container *ngFor=\"let event of day.events; let i = index\">\n            <ng-container *ngIf=\"event.order > i + 1 && i === 0\">\n              <div \n                class=\"fake-event\"\n                *ngFor=\"let fakeEvent of [].constructor(event.order - 1); let index = index\"\n                [ngStyle]=\"{ order: index + 1 }\"\n              >\n                &nbsp;\n              </div>\n            </ng-container>\n            <ng-container *ngIf=\"event.order > i + 1 && i !== 0\">\n              <div \n                class=\"fake-event\"\n                *ngFor=\"let fakeEvent of [].constructor(event.order - 1 - day.events[i - 1].order); let index = index\"\n                [ngStyle]=\"{ order: event.order - day.events[i - 1].order + 1 }\"\n              >\n                &nbsp;\n              </div>\n            </ng-container>\n            <div \n              draggable=\"true\"\n              class=\"event bg-{{event.color.background}}\"\n              [ngClass]=\"{'event-long': !event.eventStart, 'event-readonly': readonly, 'active' : hoveredEventId === event.id, 'dragging' : draggedEventId === event.id}\"\n              [ngStyle]=\"{ color: event.color.foreground, order: event.order }\"\n              *ngIf=\"event.allDay || event.longEvent\"\n              id=\"{{i === 0 ? event.id : ''}}\"\n              html=\"true\"\n              mdbTooltip=\"\n                <h6><strong>{{event.summary}}</strong></h6>\n                <p><small><em>{{event.description}}</em></small></p>\n                <p class='me-0'><small>\n                  <i class='fas fa-calendar-alt pe-1'></i>\n                  {{ twelveHours ? convertDateTo12hFormat(event.startData.string) : event.startData.string}}\n                  - \n                  {{twelveHours ? convertDateTo12hFormat(event.endData.string) : event.endData.string }}\n                </small></p>\"\n              [offset]=15\n              (click)=\"onEventClick(event); $event.stopPropagation()\"\n              (dragstart)=\"onEventDragStart(event)\"\n              (dragend)=\"onEventDragEnd(event)\"\n              (mouseenter)=\"onMouseEnter(event)\"\n              (mouseleave)=\"onMouseLeave()\"\n            >    \n              {{ event.eventStart || dayIndex === 0 ? event.summary : '&nbsp;' }}\n            </div>\n          </ng-container>\n          <ng-container *ngFor=\"let event of day.events\">\n            <div\n              draggable=\"true\" \n              class=\"event event-short\"\n              *ngIf=\"!event.allDay && !event.longEvent\"\n              [ngClass]=\"{'event-readonly': readonly, 'active' : hoveredEventId === event.id, 'dragging' : draggedEventId === event.id}\"\n              [ngStyle]=\"{ order: event.order }\"\n              html=\"true\"\n              mdbTooltip=\"\n                <h6><strong>{{event.summary}}</strong></h6>\n                <p><small><em>{{event.description}}</em></small></p>\n                <p class='me-0'><small>\n                  <i class='fas fa-calendar-alt pe-1'></i>\n                  {{ twelveHours ? convertDateTo12hFormat(event.startData.string) : event.startData.string}}\n                  - \n                  {{twelveHours ? convertDateTo12hFormat(event.endData.string) : event.endData.string }}\n                </small></p>\"\n              [offset]=15\n              (click)=\"onEventClick(event); $event.stopPropagation()\"\n              (dragstart)=\"onEventDragStart(event)\"\n              (dragend)=\"onEventDragEnd(event)\"\n              (mouseenter)=\"onMouseEnter(event)\"\n              (mouseleave)=\"onMouseLeave()\"\n            >\n              <i class=\"fas fa-circle pe-1 event-circle text-{{ event.color.background}}\"></i>\n              {{ event.summary }}\n            </div>\n          </ng-container>\n        </div>\n      </td>\n    </tr>\n     \n    <tr #hourEl *ngFor=\"let row of weekView.weekRows; let i = index\">\n      <th class=\"hour-field\" *ngIf=\"twelveHours\">\n        {{ i === 0 ? '12' : i < 12 ? i : i - 12 === 0 ? '12' : i - 12 }}:00 {{ i < 12 ? 'am' : 'pm'}}\n      </th>\n      <th class=\"hour-field\" *ngIf=\"!twelveHours\">\n        {{ i }}:00 \n      </th>\n      <td *ngFor=\"let date of row.row\"\n        (click)=\"onDayClick(date)\"\n        (mousedown)=\"onMouseDown($event, date)\"\n        (mouseup)=\"onMouseUp($event, date)\" \n        (mouseenter)=\"onMouseMove($event)\"\n        (dragenter)=\"onDragEnter($event, date)\"\n        (dragover)=\"onDragOver($event)\"\n        (dragleave)=\"onDragLeave($event)\"\n      >\n        <div\n          draggable=\"true\"\n          class=\"event event-short\"\n          *ngFor=\"let event of date.events\"\n          [ngClass]=\"{'event-readonly': readonly, 'active' : hoveredEventId === event.id, 'dragging' : draggedEventId === event.id}\"\n          html=\"true\"\n          mdbTooltip=\"\n            <h6><strong>{{event.summary}}</strong></h6>\n            <p><small><em>{{event.description}}</em></small></p>\n            <p class='me-0'><small>\n              <i class='fas fa-calendar-alt pe-1'></i>\n              {{ twelveHours ? convertDateTo12hFormat(event.startData.string) : event.startData.string}}\n              - \n              {{twelveHours ? convertDateTo12hFormat(event.endData.string) : event.endData.string }}\n            </small></p>\"\n          [offset]=15\n          (click)=\"onEventClick(event); $event.stopPropagation()\"\n          (dragstart)=\"onEventDragStart(event)\"\n          (dragend)=\"onHoursEventDragEnd(event)\"\n          (mouseenter)=\"onMouseEnter(event)\"\n          (mouseleave)=\"onMouseLeave()\"\n        >\n          <i class=\"fas fa-circle event-circle pe-1 text-{{ event.color.background }}\"></i>\n          {{event.summary}}\n        </div>\n      </td>\n    </tr>\n  </tbody>\n</table>" }]
        }], ctorParameters: function () { return [{ type: i0.Renderer2 }]; }, propDecorators: { hours: [{
                type: ViewChildren,
                args: ['hourEl']
            }], readonly: [{
                type: Input
            }], options: [{
                type: Input
            }], mondayFirst: [{
                type: Input
            }], twelveHours: [{
                type: Input
            }], activeDate: [{
                type: Input
            }], events: [{
                type: Input
            }], dayClicked: [{
                type: Output
            }], eventClicked: [{
                type: Output
            }], eventDragged: [{
                type: Output
            }] } });
function getHours(day) {
    throw new Error('Function not implemented.');
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsZW5kYXItd2Vlay12aWV3LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL21kYi1hbmd1bGFyLWNhbGVuZGFyL3NyYy9saWIvY2FsZW5kYXItd2Vlay12aWV3LmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uL3Byb2plY3RzL21kYi1hbmd1bGFyLWNhbGVuZGFyL3NyYy9saWIvY2FsZW5kYXItd2Vlay12aWV3LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFTCxTQUFTLEVBQ1QsS0FBSyxFQUNMLE1BQU0sRUFDTixZQUFZLEVBRVosWUFBWSxHQUliLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFDTCxnQkFBZ0IsRUFDaEIsZ0JBQWdCLEVBQ2hCLGlCQUFpQixFQUNqQixhQUFhLEVBQ2IsU0FBUyxFQUNULE9BQU8sRUFDUCxRQUFRLEVBQ1IsVUFBVSxFQUNWLFFBQVEsRUFDUixPQUFPLEVBQ1AsWUFBWSxFQUNaLFFBQVEsRUFDUixRQUFRLEVBQ1IsT0FBTyxFQUNQLFVBQVUsRUFDVixVQUFVLEdBQ1gsTUFBTSxrQkFBa0IsQ0FBQzs7OztBQVMxQixNQUFNLE9BQU8sNEJBQTRCO0lBbUR2QyxZQUFvQixTQUFvQjtRQUFwQixjQUFTLEdBQVQsU0FBUyxDQUFXO1FBdEI5QixlQUFVLEdBQW1DLElBQUksWUFBWSxFQUFFLENBQUM7UUFDaEUsaUJBQVksR0FBbUMsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNsRSxpQkFBWSxHQUFzQixJQUFJLFlBQVksRUFBRSxDQUFDO1FBSy9ELGVBQVUsR0FBRyxLQUFLLENBQUM7UUFZbkIsYUFBUSxHQUFrQixFQUFFLENBQUM7UUFDN0IsWUFBTyxHQUFrQixFQUFFLENBQUM7SUFFZSxDQUFDO0lBNUM1QyxJQUNJLFVBQVU7UUFDWixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7SUFDMUIsQ0FBQztJQUNELElBQUks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LDRCQUE0QjtrQkFOeEMsU0FBUzsrQkFFRSx3QkFBd0IsVUFFMUIsRUFBRTtnR0FHYyxLQUFLO3NCQUE1QixZQUFZO3VCQUFDLFFBQVE7Z0JBRWIsUUFBUTtzQkFBaEIsS0FBSztnQkFDRyxPQUFPO3NCQUFmLEtBQUs7Z0JBQ0csV0FBVztzQkFBbkIsS0FBSztnQkFDRyxXQUFXO3NCQUFuQixLQUFLO2dCQUVGLFVBQVU7c0JBRGIsS0FBSztnQkFVRixNQUFNO3NCQURULEtBQUs7Z0JBYUksVUFBVTtzQkFBbkIsTUFBTTtnQkFDRyxZQUFZO3NCQUFyQixNQUFNO2dCQUNHLFlBQVk7c0JBQXJCLE1BQU07O0FBNlFULFNBQVMsUUFBUSxDQUFDLEdBQVE7SUFDeEIsTUFBTSxJQUFJLEtBQUssQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO0FBQy9DLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBPbkluaXQsXG4gIENvbXBvbmVudCxcbiAgSW5wdXQsXG4gIE91dHB1dCxcbiAgRXZlbnRFbWl0dGVyLFxuICBSZW5kZXJlcjIsXG4gIFZpZXdDaGlsZHJlbixcbiAgUXVlcnlMaXN0LFxuICBFbGVtZW50UmVmLFxuICBBZnRlclZpZXdJbml0LFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIGNvbnZlcnREYXRlVG8xMmgsXG4gIGRpZmZlcmVuY2VJbkRheXMsXG4gIGRpZmZlcmVuY2VJbkhvdXJzLFxuICBnZW5lcmF0ZUV2ZW50LFxuICBnZXRFdmVudHMsXG4gIGFkZERheXMsXG4gIGFkZEhvdXJzLFxuICBhZGRNaW51dGVzLFxuICBlbmRPZkRheSxcbiAgZ2V0RGF0ZSxcbiAgZ2V0RGF5TnVtYmVyLFxuICBnZXRNb250aCxcbiAgZ2V0VG9kYXksXG4gIGdldFllYXIsXG4gIGlzU2FtZURhdGUsXG4gIHN0YXJ0T2ZEYXksXG59IGZyb20gJy4vY2FsZW5kYXIudXRpbHMnO1xuaW1wb3J0IHsgTWRiQ2FsZW5kYXJFdmVudCB9IGZyb20gJy4vY2FsZW5kYXIuZXZlbnQuaW50ZXJmYWNlJztcblxuQENvbXBvbmVudCh7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvY29tcG9uZW50LXNlbGVjdG9yXG4gIHNlbGVjdG9yOiAnbWRiLXdlZWstdmlldy1jYWxlbmRhcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9jYWxlbmRhci13ZWVrLXZpZXcuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZXM6IFtdLFxufSlcbmV4cG9ydCBjbGFzcyBNZGJDYWxlbmRhcldlZWtWaWV3Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0IHtcbiAgQFZpZXdDaGlsZHJlbignaG91ckVsJykgaG91cnM6IFF1ZXJ5TGlzdDxFbGVtZW50UmVmPjtcblxuICBASW5wdXQoKSByZWFkb25seTogYm9vbGVhbjtcbiAgQElucHV0KCkgb3B0aW9ucztcbiAgQElucHV0KCkgbW9uZGF5Rmlyc3Q6IGJvb2xlYW47XG4gIEBJbnB1dCgpIHR3ZWx2ZUhvdXJzOiBib29sZWFuO1xuICBASW5wdXQoKVxuICBnZXQgYWN0aXZlRGF0ZSgpOiBEYXRlIHtcbiAgICByZXR1cm4gdGhpcy5fYWN0aXZlRGF0ZTtcbiAgfVxuICBzZXQgYWN0aXZlRGF0ZShkYXRlOiBEYXRlKSB7XG4gICAgdGhpcy5fYWN0aXZlRGF0ZSA9IGRhdGU7XG4gICAgdGhpcy53ZWVrVmlldyA9IHRoaXMuX2dlbmVyYXRlV2Vla1ZpZXcoKTtcbiAgfVxuICBwcml2YXRlIF9hY3RpdmVEYXRlOiBEYXRlO1xuICBASW5wdXQoKVxuICBnZXQgZXZlbnRzKCkge1xuICAgIHJldHVybiB0aGlzLl9ldmVudHM7XG4gIH1cbiAgc2V0IGV2ZW50cyhldmVudHM6IE1kYkNhbGVuZGFyRXZlbnRbXSkge1xuICAgIGlmICghZXZlbnRzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX2V2ZW50cyA9IGV2ZW50cztcbiAgICB0aGlzLndlZWtWaWV3ID0gdGhpcy5fZ2VuZXJhdGVXZWVrVmlldygpO1xuICB9XG4gIHByaXZhdGUgX2V2ZW50czogTWRiQ2FsZW5kYXJFdmVudFtdO1xuXG4gIEBPdXRwdXQoKSBkYXlDbGlja2VkOiBFdmVudEVtaXR0ZXI8TWRiQ2FsZW5kYXJFdmVudD4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBPdXRwdXQoKSBldmVudENsaWNrZWQ6IEV2ZW50RW1pdHRlcjxNZGJDYWxlbmRhckV2ZW50PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgQE91dHB1dCgpIGV2ZW50RHJhZ2dlZDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgd2Vla1ZpZXc7XG4gIGhvdXJzRWw7XG5cbiAgaXNEcmFnZ2luZyA9IGZhbHNlO1xuXG4gIGRyYWdTdGFydDogYW55O1xuICBkcmFnRW5kOiBhbnk7XG5cbiAgc2VsZWN0aW9uU3RhcnREYXk6IERhdGU7XG4gIHNlbGVjdGlvbkVuZERheTogRGF0ZTtcblxuICBkcmFnVGFyZ2V0RGF5O1xuICBob3ZlcmVkRXZlbnRJZDtcbiAgZHJhZ2dlZEV2ZW50SWQ7XG5cbiAgZGF5Q2VsbHM6IEhUTUxFbGVtZW50W10gPSBbXTtcbiAgY29sdW1uczogSFRNTEVsZW1lbnRbXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgX3JlbmRlcmVyOiBSZW5kZXJlcjIpIHt9XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy53ZWVrVmlldyA9IHRoaXMuX2dlbmVyYXRlV2Vla1ZpZXcoKTtcbiAgfVxuXG4gIG9uRXZlbnRDbGljayhldmVudDogTWRiQ2FsZW5kYXJFdmVudCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnJlYWRvbmx5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5ldmVudENsaWNrZWQuZW1pdChldmVudCk7XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XG4gICAgdGhpcy5ob3Vyc0VsID0gdGhpcy5ob3Vycy50b0FycmF5KCkubWFwKChlbDogRWxlbWVudFJlZikgPT4gZWwubmF0aXZlRWxlbWVudCk7XG5cbiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSA3OyBpKyspIHtcbiAgICAgIHRoaXMuaG91cnNFbC5mb3JFYWNoKChyb3c6IGFueSkgPT4ge1xuICAgICAgICB0aGlzLmNvbHVtbnMucHVzaChyb3cuY2hpbGRyZW5baV0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgb25EYXlDbGljayhkYXk6IGFueSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnJlYWRvbmx5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IHN0YXJ0RGF0ZSA9IGFkZE1pbnV0ZXMobmV3IERhdGUoZGF5LmRhdGUuZ2V0VGltZSgpKSwgLTU5KTtcbiAgICBsZXQgZW5kRGF0ZSA9IGRheS5kYXRlO1xuXG4gICAgaWYgKGRheS5kYXRlLmdldEhvdXJzKCkgPT09IDApIHtcbiAgICAgIHN0YXJ0RGF0ZSA9IHN0YXJ0T2ZEYXkoZGF5LmRhdGUpO1xuICAgICAgZW5kRGF0ZSA9ICcnO1xuICAgIH1cblxuICAgIGNvbnN0IG5ld0NhbGVuZGFyRXZlbnQgPSBnZW5lcmF0ZUV2ZW50KHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7XG5cbiAgICB0aGlzLmRheUNsaWNrZWQuZW1pdChuZXdDYWxlbmRhckV2ZW50KTtcbiAgfVxuXG4gIG9uTW91c2VEb3duKGV2ZW50OiBNb3VzZUV2ZW50LCBkYXk6IGFueSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnJlYWRvbmx5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTtcbiAgICB0aGlzLmRyYWdTdGFydCA9IHRoaXMuY29sdW1ucy5pbmRleE9mKGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudCk7XG4gICAgdGhpcy5zZWxlY3Rpb25TdGFydERheSA9IGRheS5kYXRlO1xuICB9XG5cbiAgb25Nb3VzZVVwKGV2ZW50OiBNb3VzZUV2ZW50LCBkYXk6IGFueSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnJlYWRvbmx5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5pc0RyYWdnaW5nID0gZmFsc2U7XG4gICAgdGhpcy5kcmFnRW5kID0gdGhpcy5jb2x1bW5zLmluZGV4T2YoZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50KTtcbiAgICBpZiAodGhpcy5kcmFnRW5kICE9PSAwKSB7XG4gICAgICB0aGlzLnNlbGVjdFJhbmdlKCk7XG4gICAgfVxuXG4gICAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xuICAgIHRoaXMuc2VsZWN0aW9uRW5kRGF5ID0gZGF5LmRhdGU7XG5cbiAgICBpZiAodGhpcy5zZWxlY3Rpb25TdGFydERheSA9PT0gdGhpcy5zZWxlY3Rpb25FbmREYXkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBuZXdDYWxlbmRhckV2ZW50ID0gZ2VuZXJhdGVFdmVudChcbiAgICAgIGFkZE1pbnV0ZXMobmV3IERhdGUodGhpcy5zZWxlY3Rpb25TdGFydERheS5nZXRUaW1lKCkpLCAtNTkpLFxuICAgICAgYWRkTWludXRlcyhuZXcgRGF0ZSh0aGlzLnNlbGVjdGlvbkVuZERheS5nZXRUaW1lKCkpLCAtNTkpXG4gICAgKTtcblxuICAgIHRoaXMuZGF5Q2xpY2tlZC5lbWl0KG5ld0NhbGVuZGFyRXZlbnQpO1xuICB9XG5cbiAgb25Nb3VzZU1vdmUoZXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5yZWFkb25seSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYgKHRoaXMuaXNEcmFnZ2luZykge1xuICAgICAgdGhpcy5kcmFnRW5kID0gdGhpcy5jb2x1bW5zLmluZGV4T2YoZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50KTtcbiAgICAgIHRoaXMuc2VsZWN0UmFuZ2UoKTtcbiAgICB9XG4gIH1cblxuICBvbkV2ZW50RHJhZ1N0YXJ0KGNhbGVuZGFyRXZlbnQ6IE1kYkNhbGVuZGFyRXZlbnQpOiB2b2lkIHtcbiAgICB0aGlzLmRyYWdnZWRFdmVudElkID0gY2FsZW5kYXJFdmVudC5pZDtcbiAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gIH1cblxuICBvbkV2ZW50RHJhZ0VuZChjYWxlbmRhckV2ZW50OiBNZGJDYWxlbmRhckV2ZW50KTogdm9pZCB7XG4gICAgdGhpcy5kcmFnZ2VkRXZlbnRJZCA9ICcnO1xuICAgIHRoaXMuaG92ZXJlZEV2ZW50SWQgPSAnJztcblxuICAgIGNvbnN0IGRheXNEaWZmZXJlbmNlID0gZGlmZmVyZW5jZUluRGF5cyhcbiAgICAgIHN0YXJ0T2ZEYXkobmV3IERhdGUoY2FsZW5kYXJFdmVudC5zdGFydERhdGUgYXMgRGF0ZSkpLFxuICAgICAgYWRkRGF5cyh0aGlzLmRyYWdUYXJnZXREYXkuZGF0ZSwgLTEpXG4gICAgKTtcbiAgICBjb25zdCBuZXdTdGFydERhdGUgPSBhZGREYXlzKGNhbGVuZGFyRXZlbnQuc3RhcnREYXRlIGFzIERhdGUsIGRheXNEaWZmZXJlbmNlKTtcbiAgICBjb25zdCBuZXdFbmREYXRlID0gYWRkRGF5cyhjYWxlbmRhckV2ZW50LmVuZERhdGUgYXMgRGF0ZSwgZGF5c0RpZmZlcmVuY2UpO1xuXG4gICAgY29uc3QgbmV3RXZlbnQgPSB7XG4gICAgICAuLi5jYWxlbmRhckV2ZW50LFxuICAgICAgc3RhcnREYXRlOiBuZXdTdGFydERhdGUsXG4gICAgICBlbmREYXRlOiBuZXdFbmREYXRlLFxuICAgICAgb3JkZXI6ICcnLFxuICAgIH07XG5cbiAgICB0aGlzLmV2ZW50RHJhZ2dlZC5lbWl0KG5ld0V2ZW50KTtcbiAgfVxuXG4gIG9uSG91cnNFdmVudERyYWdFbmQoY2FsZW5kYXJFdmVudDogTWRiQ2FsZW5kYXJFdmVudCk6IHZvaWQge1xuICAgIHRoaXMuZHJhZ2dlZEV2ZW50SWQgPSAnJztcbiAgICB0aGlzLmhvdmVyZWRFdmVudElkID0gJyc7XG5cbiAgICBjb25zdCBkYXlzRGlmZmVyZW5jZSA9IGRpZmZlcmVuY2VJbkhvdXJzKFxuICAgICAgY2FsZW5kYXJFdmVudC5zdGFydERhdGUgYXMgRGF0ZSxcbiAgICAgIHRoaXMuZHJhZ1RhcmdldERheS5kYXRlXG4gICAgKTtcbiAgICBjb25zdCBuZXdTdGFydERhdGUgPSBhZGRIb3VycyhjYWxlbmRhckV2ZW50LnN0YXJ0RGF0ZSBhcyBEYXRlLCBkYXlzRGlmZmVyZW5jZSk7XG4gICAgY29uc3QgbmV3RW5kRGF0ZSA9IGFkZEhvdXJzKGNhbGVuZGFyRXZlbnQuZW5kRGF0ZSBhcyBEYXRlLCBkYXlzRGlmZmVyZW5jZSk7XG5cbiAgICBjb25zdCBuZXdFdmVudCA9IHtcbiAgICAgIC4uLmNhbGVuZGFyRXZlbnQsXG4gICAgICBzdGFydERhdGU6IG5ld1N0YXJ0RGF0ZSxcbiAgICAgIGVuZERhdGU6IG5ld0VuZERhdGUsXG4gICAgICBvcmRlcjogJycsXG4gICAgfTtcblxuICAgIHRoaXMuZXZlbnREcmFnZ2VkLmVtaXQobmV3RXZlbnQpO1xuICB9XG5cbiAgb25EcmFnRW50ZXIoZXZlbnQ6IERyYWdFdmVudCwgZGF5OiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyhldmVudC50YXJnZXQsICdkcmFnZW50ZXInKTtcbiAgICB0aGlzLmRyYWdUYXJnZXREYXkgPSBkYXk7XG4gIH1cblxuICBvbkRyYWdMZWF2ZShldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XG4gICAgdGhpcy5fcmVuZGVyZXIucmVtb3ZlQ2xhc3MoZXZlbnQudGFyZ2V0LCAnZHJhZ2VudGVyJyk7XG4gIH1cblxuICBvbkRyYWdPdmVyKGV2ZW50OiBEcmFnRXZlbnQpOiBib29sZWFuIHtcbiAgICBpZiAoZXZlbnQucHJldmVudERlZmF1bHQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIG9uTW91c2VFbnRlcihldmVudDogTWRiQ2FsZW5kYXJFdmVudCk6IHZvaWQge1xuICAgIHRoaXMuaG92ZXJlZEV2ZW50SWQgPSBldmVudC5pZDtcbiAgfVxuXG4gIG9uTW91c2VMZWF2ZSgpOiB2b2lkIHtcbiAgICB0aGlzLmhvdmVyZWRFdmVudElkID0gJyc7XG4gIH1cblxuICBzZWxlY3RSYW5nZSgpOiB2b2lkIHtcbiAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgaWYgKHRoaXMuZHJhZ0VuZCArIDEgPCB0aGlzLmRyYWdTdGFydCkge1xuICAgICAgdGhpcy5jb2x1bW5zXG4gICAgICAgIC5zbGljZSh0aGlzLmRyYWdFbmQsIHRoaXMuZHJhZ1N0YXJ0ICsgMSlcbiAgICAgICAgLmZvckVhY2goKGNlbGwpID0+IHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGNlbGwsICdiYWNrZ3JvdW5kLWNvbG9yJywgJyNmYWZhZmEnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY29sdW1ucy5zbGljZSh0aGlzLmRyYWdTdGFydCwgdGhpcy5kcmFnRW5kICsgMSkuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShjZWxsLCAnYmFja2dyb3VuZC1jb2xvcicsICcjZmFmYWZhJyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBjb252ZXJ0RGF0ZVRvMTJoRm9ybWF0KGRhdGU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGNvbnZlcnREYXRlVG8xMmgoZGF0ZSk7XG4gIH1cblxuICBjbGVhclNlbGVjdGlvbigpOiB2b2lkIHtcbiAgICB0aGlzLmNvbHVtbnMuZm9yRWFjaCgoY2VsbCkgPT4gdGhpcy5fcmVuZGVyZXIucmVtb3ZlU3R5bGUoY2VsbCwgJ2JhY2tncm91bmQtY29sb3InKSk7XG4gIH1cblxuICBfZ2VuZXJhdGVXZWVrVmlldygpOiBhbnkge1xuICAgIGNvbnN0IHN1bmRheUluZGV4ID0gdGhpcy5tb25kYXlGaXJzdCA/IDEgOiAwO1xuICAgIGNvbnN0IGZpcnN0RGF5ID0gYWRkRGF5cyh0aGlzLmFjdGl2ZURhdGUsIC1nZXREYXlOdW1iZXIodGhpcy5hY3RpdmVEYXRlKSArIHN1bmRheUluZGV4KTtcbiAgICBjb25zdCBsYXN0RGF5ID0gYWRkRGF5cyhmaXJzdERheSwgNik7XG5cbiAgICBjb25zdCBwZXJpb2QgPSB7XG4gICAgICBzdGFydDogYCR7dGhpcy5vcHRpb25zLm1vbnRoc1Nob3J0W2dldE1vbnRoKGZpcnN0RGF5KV19ICR7Z2V0RGF0ZShmaXJzdERheSl9YCxcbiAgICAgIGVuZDogYCR7dGhpcy5vcHRpb25zLm1vbnRoc1Nob3J0W2dldE1vbnRoKGxhc3REYXkpXX0gJHtnZXREYXRlKGxhc3REYXkpfSwgJHtnZXRZZWFyKFxuICAgICAgICBsYXN0RGF5XG4gICAgICApfWAsXG4gICAgfTtcblxuICAgIGNvbnN0IGFsbERheVJvdyA9IFtdO1xuICAgIGNvbnN0IHdlZWtSb3dzID0gW107XG4gICAgbGV0IHJvdyA9IFtdO1xuICAgIGxldCBkYXRlOiBEYXRlO1xuICAgIGxldCBtb250aDogbnVtYmVyIHwgc3RyaW5nO1xuICAgIGxldCBkYXk6IHN0cmluZztcbiAgICBsZXQgZGF5TnVtYmVyOiBudW1iZXIgfCBzdHJpbmc7XG4gICAgbGV0IHN0YXJ0RGF0ZTogRGF0ZTtcbiAgICBsZXQgZW5kRGF0ZTogRGF0ZTtcbiAgICBsZXQgZGF5U3RhcnQ6IERhdGU7XG4gICAgbGV0IGRheUVuZDogRGF0ZTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjQ7IGkrKykge1xuICAgICAgcm93ID0gW107XG5cbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgNzsgaisrKSB7XG4gICAgICAgIGRhdGUgPSBhZGREYXlzKGZpcnN0RGF5LCBqKTtcbiAgICAgICAgbW9udGggPSBnZXRNb250aChkYXRlKSArIDE7XG4gICAgICAgIGRheSA9IHRoaXMub3B0aW9ucy53ZWVrZGF5c1tnZXREYXlOdW1iZXIoZGF0ZSldO1xuICAgICAgICBkYXlOdW1iZXIgPSBnZXREYXRlKGRhdGUpO1xuICAgICAgICBzdGFydERhdGUgPSBhZGRIb3VycyhzdGFydE9mRGF5KGRhdGUpLCBpKTtcbiAgICAgICAgZW5kRGF0ZSA9IGFkZE1pbnV0ZXMoc3RhcnREYXRlLCA1OS45OSk7XG4gICAgICAgIGRheVN0YXJ0ID0gc3RhcnRPZkRheShkYXRlKTtcbiAgICAgICAgZGF5RW5kID0gZW5kT2ZEYXkoZGF0ZSk7XG5cbiAgICAgICAgaWYgKG1vbnRoIDwgMTApIHtcbiAgICAgICAgICBtb250aCA9ICcwJyArIG1vbnRoO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRheU51bWJlciA8IDEwKSB7XG4gICAgICAgICAgZGF5TnVtYmVyID0gJzAnICsgZGF5TnVtYmVyO1xuICAgICAgICB9XG5cbiAgICAgICAgcm93LnB1c2goe1xuICAgICAgICAgIGRhdGU6IHN0YXJ0RGF0ZSxcbiAgICAgICAgICBpc1RvZGF5OiBpc1NhbWVEYXRlKGRhdGUsIGdldFRvZGF5KCkpLFxuICAgICAgICAgIGV2ZW50czogZ2V0RXZlbnRzKHRoaXMuZXZlbnRzLCBzdGFydERhdGUsIGVuZERhdGUsIHRydWUpLFxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoaSA9PT0gMSkge1xuICAgICAgICAgIGFsbERheVJvdy5wdXNoKHtcbiAgICAgICAgICAgIGRhdGU6IGFkZERheXMoZGF0ZSwgMSksXG4gICAgICAgICAgICBpc1RvZGF5OiBpc1NhbWVEYXRlKGRhdGUsIGdldFRvZGF5KCkpLFxuICAgICAgICAgICAgZGF5OiBkYXksXG4gICAgICAgICAgICBkYXlOdW1iZXI6IGRheU51bWJlcixcbiAgICAgICAgICAgIG1vbnRoOiBtb250aCxcbiAgICAgICAgICAgIGV2ZW50czogZ2V0RXZlbnRzKHRoaXMuZXZlbnRzLCBkYXlTdGFydCwgZGF5RW5kKSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgd2Vla1Jvd3MucHVzaCh7IHJvdyB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHsgYWxsRGF5Um93LCB3ZWVrUm93cywgcGVyaW9kIH07XG4gIH1cbn1cbmZ1bmN0aW9uIGdldEhvdXJzKGRheTogYW55KTogYW55IHtcbiAgdGhyb3cgbmV3IEVycm9yKCdGdW5jdGlvbiBub3QgaW1wbGVtZW50ZWQuJyk7XG59XG4iLCI8dGFibGU+XG4gIDx0aGVhZD5cbiAgICA8dHI+XG4gICAgICA8dGg+PC90aD5cbiAgICAgIDx0aCAqbmdGb3I9XCJsZXQgZGF5IG9mIHdlZWtWaWV3LmFsbERheVJvd1wiPlxuICAgICAgICB7eyBkYXkuZGF5IH19IHt7IGRheS5kYXlOdW1iZXIgfX0ve3sgZGF5Lm1vbnRoIH19XG4gICAgICA8L3RoPlxuICAgIDwvdHI+XG4gIDwvdGhlYWQ+XG4gIDx0Ym9keT5cbiAgICA8dHIgY2xhc3M9XCJsb25nLWV2ZW50LXJvd1wiPlxuICAgICAgPHRoPjwvdGg+XG4gICAgICA8dGQgXG4gICAgICAgICpuZ0Zvcj1cImxldCBkYXkgb2Ygd2Vla1ZpZXcuYWxsRGF5Um93OyBsZXQgZGF5SW5kZXggPSBpbmRleFwiXG4gICAgICAgIFtuZ0NsYXNzXT1cInsndG9kYXknOiBkYXkuaXNUb2RheX1cIlxuICAgICAgICAoY2xpY2spPVwib25EYXlDbGljayhkYXkpXCJcbiAgICAgICAgKG1vdXNlZG93bik9XCJvbk1vdXNlRG93bigkZXZlbnQsIGRheSlcIlxuICAgICAgICAobW91c2V1cCk9XCJvbk1vdXNlVXAoJGV2ZW50LCBkYXkpXCIgXG4gICAgICAgIChtb3VzZWVudGVyKT1cIm9uTW91c2VNb3ZlKCRldmVudClcIlxuICAgICAgICAoZHJhZ2VudGVyKT1cIm9uRHJhZ0VudGVyKCRldmVudCwgZGF5KVwiXG4gICAgICAgIChkcmFnb3Zlcik9XCJvbkRyYWdPdmVyKCRldmVudClcIlxuICAgICAgICAoZHJhZ2xlYXZlKT1cIm9uRHJhZ0xlYXZlKCRldmVudClcIlxuICAgICAgPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZXZlbnRzLXdyYXBwZXJcIj5cbiAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBldmVudCBvZiBkYXkuZXZlbnRzOyBsZXQgaSA9IGluZGV4XCI+XG4gICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiZXZlbnQub3JkZXIgPiBpICsgMSAmJiBpID09PSAwXCI+XG4gICAgICAgICAgICAgIDxkaXYgXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJmYWtlLWV2ZW50XCJcbiAgICAgICAgICAgICAgICAqbmdGb3I9XCJsZXQgZmFrZUV2ZW50IG9mIFtdLmNvbnN0cnVjdG9yKGV2ZW50Lm9yZGVyIC0gMSk7IGxldCBpbmRleCA9IGluZGV4XCJcbiAgICAgICAgICAgICAgICBbbmdTdHlsZV09XCJ7IG9yZGVyOiBpbmRleCArIDEgfVwiXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJldmVudC5vcmRlciA+IGkgKyAxICYmIGkgIT09IDBcIj5cbiAgICAgICAgICAgICAgPGRpdiBcbiAgICAgICAgICAgICAgICBjbGFzcz1cImZha2UtZXZlbnRcIlxuICAgICAgICAgICAgICAgICpuZ0Zvcj1cImxldCBmYWtlRXZlbnQgb2YgW10uY29uc3RydWN0b3IoZXZlbnQub3JkZXIgLSAxIC0gZGF5LmV2ZW50c1tpIC0gMV0ub3JkZXIpOyBsZXQgaW5kZXggPSBpbmRleFwiXG4gICAgICAgICAgICAgICAgW25nU3R5bGVdPVwieyBvcmRlcjogZXZlbnQub3JkZXIgLSBkYXkuZXZlbnRzW2kgLSAxXS5vcmRlciArIDEgfVwiXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgIDxkaXYgXG4gICAgICAgICAgICAgIGRyYWdnYWJsZT1cInRydWVcIlxuICAgICAgICAgICAgICBjbGFzcz1cImV2ZW50IGJnLXt7ZXZlbnQuY29sb3IuYmFja2dyb3VuZH19XCJcbiAgICAgICAgICAgICAgW25nQ2xhc3NdPVwieydldmVudC1sb25nJzogIWV2ZW50LmV2ZW50U3RhcnQsICdldmVudC1yZWFkb25seSc6IHJlYWRvbmx5LCAnYWN0aXZlJyA6IGhvdmVyZWRFdmVudElkID09PSBldmVudC5pZCwgJ2RyYWdnaW5nJyA6IGRyYWdnZWRFdmVudElkID09PSBldmVudC5pZH1cIlxuICAgICAgICAgICAgICBbbmdTdHlsZV09XCJ7IGNvbG9yOiBldmVudC5jb2xvci5mb3JlZ3JvdW5kLCBvcmRlcjogZXZlbnQub3JkZXIgfVwiXG4gICAgICAgICAgICAgICpuZ0lmPVwiZXZlbnQuYWxsRGF5IHx8IGV2ZW50LmxvbmdFdmVudFwiXG4gICAgICAgICAgICAgIGlkPVwie3tpID09PSAwID8gZXZlbnQuaWQgOiAnJ319XCJcbiAgICAgICAgICAgICAgaHRtbD1cInRydWVcIlxuICAgICAgICAgICAgICBtZGJUb29sdGlwPVwiXG4gICAgICAgICAgICAgICAgPGg2PjxzdHJvbmc+e3tldmVudC5zdW1tYXJ5fX08L3N0cm9uZz48L2g2PlxuICAgICAgICAgICAgICAgIDxwPjxzbWFsbD48ZW0+e3tldmVudC5kZXNjcmlwdGlvbn19PC9lbT48L3NtYWxsPjwvcD5cbiAgICAgICAgICAgICAgICA8cCBjbGFzcz0nbWUtMCc+PHNtYWxsPlxuICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9J2ZhcyBmYS1jYWxlbmRhci1hbHQgcGUtMSc+PC9pPlxuICAgICAgICAgICAgICAgICAge3sgdHdlbHZlSG91cnMgPyBjb252ZXJ0RGF0ZVRvMTJoRm9ybWF0KGV2ZW50LnN0YXJ0RGF0YS5zdHJpbmcpIDogZXZlbnQuc3RhcnREYXRhLnN0cmluZ319XG4gICAgICAgICAgICAgICAgICAtIFxuICAgICAgICAgICAgICAgICAge3t0d2VsdmVIb3VycyA/IGNvbnZlcnREYXRlVG8xMmhGb3JtYXQoZXZlbnQuZW5kRGF0YS5zdHJpbmcpIDogZXZlbnQuZW5kRGF0YS5zdHJpbmcgfX1cbiAgICAgICAgICAgICAgICA8L3NtYWxsPjwvcD5cIlxuICAgICAgICAgICAgICBbb2Zmc2V0XT0xNVxuICAgICAgICAgICAgICAoY2xpY2spPVwib25FdmVudENsaWNrKGV2ZW50KTsgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpXCJcbiAgICAgICAgICAgICAgKGRyYWdzdGFydCk9XCJvbkV2ZW50RHJhZ1N0YXJ0KGV2ZW50KVwiXG4gICAgICAgICAgICAgIChkcmFnZW5kKT1cIm9uRXZlbnREcmFnRW5kKGV2ZW50KVwiXG4gICAgICAgICAgICAgIChtb3VzZWVudGVyKT1cIm9uTW91c2VFbnRlcihldmVudClcIlxuICAgICAgICAgICAgICAobW91c2VsZWF2ZSk9XCJvbk1vdXNlTGVhdmUoKVwiXG4gICAgICAgICAgICA+ICAgIFxuICAgICAgICAgICAgICB7eyBldmVudC5ldmVudFN0YXJ0IHx8IGRheUluZGV4ID09PSAwID8gZXZlbnQuc3VtbWFyeSA6ICcmbmJzcDsnIH19XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBldmVudCBvZiBkYXkuZXZlbnRzXCI+XG4gICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgIGRyYWdnYWJsZT1cInRydWVcIiBcbiAgICAgICAgICAgICAgY2xhc3M9XCJldmVudCBldmVudC1zaG9ydFwiXG4gICAgICAgICAgICAgICpuZ0lmPVwiIWV2ZW50LmFsbERheSAmJiAhZXZlbnQubG9uZ0V2ZW50XCJcbiAgICAgICAgICAgICAgW25nQ2xhc3NdPVwieydldmVudC1yZWFkb25seSc6IHJlYWRvbmx5LCAnYWN0aXZlJyA6IGhvdmVyZWRFdmVudElkID09PSBldmVudC5pZCwgJ2RyYWdnaW5nJyA6IGRyYWdnZWRFdmVudElkID09PSBldmVudC5pZH1cIlxuICAgICAgICAgICAgICBbbmdTdHlsZV09XCJ7IG9yZGVyOiBldmVudC5vcmRlciB9XCJcbiAgICAgICAgICAgICAgaHRtbD1cInRydWVcIlxuICAgICAgICAgICAgICBtZGJUb29sdGlwPVwiXG4gICAgICAgICAgICAgICAgPGg2PjxzdHJvbmc+e3tldmVudC5zdW1tYXJ5fX08L3N0cm9uZz48L2g2PlxuICAgICAgICAgICAgICAgIDxwPjxzbWFsbD48ZW0+e3tldmVudC5kZXNjcmlwdGlvbn19PC9lbT48L3NtYWxsPjwvcD5cbiAgICAgICAgICAgICAgICA8cCBjbGFzcz0nbWUtMCc+PHNtYWxsPlxuICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9J2ZhcyBmYS1jYWxlbmRhci1hbHQgcGUtMSc+PC9pPlxuICAgICAgICAgICAgICAgICAge3sgdHdlbHZlSG91cnMgPyBjb252ZXJ0RGF0ZVRvMTJoRm9ybWF0KGV2ZW50LnN0YXJ0RGF0YS5zdHJpbmcpIDogZXZlbnQuc3RhcnREYXRhLnN0cmluZ319XG4gICAgICAgICAgICAgICAgICAtIFxuICAgICAgICAgICAgICAgICAge3t0d2VsdmVIb3VycyA/IGNvbnZlcnREYXRlVG8xMmhGb3JtYXQoZXZlbnQuZW5kRGF0YS5zdHJpbmcpIDogZXZlbnQuZW5kRGF0YS5zdHJpbmcgfX1cbiAgICAgICAgICAgICAgICA8L3NtYWxsPjwvcD5cIlxuICAgICAgICAgICAgICBbb2Zmc2V0XT0xNVxuICAgICAgICAgICAgICAoY2xpY2spPVwib25FdmVudENsaWNrKGV2ZW50KTsgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpXCJcbiAgICAgICAgICAgICAgKGRyYWdzdGFydCk9XCJvbkV2ZW50RHJhZ1N0YXJ0KGV2ZW50KVwiXG4gICAgICAgICAgICAgIChkcmFnZW5kKT1cIm9uRXZlbnREcmFnRW5kKGV2ZW50KVwiXG4gICAgICAgICAgICAgIChtb3VzZWVudGVyKT1cIm9uTW91c2VFbnRlcihldmVudClcIlxuICAgICAgICAgICAgICAobW91c2VsZWF2ZSk9XCJvbk1vdXNlTGVhdmUoKVwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxpIGNsYXNzPVwiZmFzIGZhLWNpcmNsZSBwZS0xIGV2ZW50LWNpcmNsZSB0ZXh0LXt7IGV2ZW50LmNvbG9yLmJhY2tncm91bmR9fVwiPjwvaT5cbiAgICAgICAgICAgICAge3sgZXZlbnQuc3VtbWFyeSB9fVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC90ZD5cbiAgICA8L3RyPlxuICAgICBcbiAgICA8dHIgI2hvdXJFbCAqbmdGb3I9XCJsZXQgcm93IG9mIHdlZWtWaWV3LndlZWtSb3dzOyBsZXQgaSA9IGluZGV4XCI+XG4gICAgICA8dGggY2xhc3M9XCJob3VyLWZpZWxkXCIgKm5nSWY9XCJ0d2VsdmVIb3Vyc1wiPlxuICAgICAgICB7eyBpID09PSAwID8gJzEyJyA6IGkgPCAxMiA/IGkgOiBpIC0gMTIgPT09IDAgPyAnMTInIDogaSAtIDEyIH19OjAwIHt7IGkgPCAxMiA/ICdhbScgOiAncG0nfX1cbiAgICAgIDwvdGg+XG4gICAgICA8dGggY2xhc3M9XCJob3VyLWZpZWxkXCIgKm5nSWY9XCIhdHdlbHZlSG91cnNcIj5cbiAgICAgICAge3sgaSB9fTowMCBcbiAgICAgIDwvdGg+XG4gICAgICA8dGQgKm5nRm9yPVwibGV0IGRhdGUgb2Ygcm93LnJvd1wiXG4gICAgICAgIChjbGljayk9XCJvbkRheUNsaWNrKGRhdGUpXCJcbiAgICAgICAgKG1vdXNlZG93bik9XCJvbk1vdXNlRG93bigkZXZlbnQsIGRhdGUpXCJcbiAgICAgICAgKG1vdXNldXApPVwib25Nb3VzZVVwKCRldmVudCwgZGF0ZSlcIiBcbiAgICAgICAgKG1vdXNlZW50ZXIpPVwib25Nb3VzZU1vdmUoJGV2ZW50KVwiXG4gICAgICAgIChkcmFnZW50ZXIpPVwib25EcmFnRW50ZXIoJGV2ZW50LCBkYXRlKVwiXG4gICAgICAgIChkcmFnb3Zlcik9XCJvbkRyYWdPdmVyKCRldmVudClcIlxuICAgICAgICAoZHJhZ2xlYXZlKT1cIm9uRHJhZ0xlYXZlKCRldmVudClcIlxuICAgICAgPlxuICAgICAgICA8ZGl2XG4gICAgICAgICAgZHJhZ2dhYmxlPVwidHJ1ZVwiXG4gICAgICAgICAgY2xhc3M9XCJldmVudCBldmVudC1zaG9ydFwiXG4gICAgICAgICAgKm5nRm9yPVwibGV0IGV2ZW50IG9mIGRhdGUuZXZlbnRzXCJcbiAgICAgICAgICBbbmdDbGFzc109XCJ7J2V2ZW50LXJlYWRvbmx5JzogcmVhZG9ubHksICdhY3RpdmUnIDogaG92ZXJlZEV2ZW50SWQgPT09IGV2ZW50LmlkLCAnZHJhZ2dpbmcnIDogZHJhZ2dlZEV2ZW50SWQgPT09IGV2ZW50LmlkfVwiXG4gICAgICAgICAgaHRtbD1cInRydWVcIlxuICAgICAgICAgIG1kYlRvb2x0aXA9XCJcbiAgICAgICAgICAgIDxoNj48c3Ryb25nPnt7ZXZlbnQuc3VtbWFyeX19PC9zdHJvbmc+PC9oNj5cbiAgICAgICAgICAgIDxwPjxzbWFsbD48ZW0+e3tldmVudC5kZXNjcmlwdGlvbn19PC9lbT48L3NtYWxsPjwvcD5cbiAgICAgICAgICAgIDxwIGNsYXNzPSdtZS0wJz48c21hbGw+XG4gICAgICAgICAgICAgIDxpIGNsYXNzPSdmYXMgZmEtY2FsZW5kYXItYWx0IHBlLTEnPjwvaT5cbiAgICAgICAgICAgICAge3sgdHdlbHZlSG91cnMgPyBjb252ZXJ0RGF0ZVRvMTJoRm9ybWF0KGV2ZW50LnN0YXJ0RGF0YS5zdHJpbmcpIDogZXZlbnQuc3RhcnREYXRhLnN0cmluZ319XG4gICAgICAgICAgICAgIC0gXG4gICAgICAgICAgICAgIHt7dHdlbHZlSG91cnMgPyBjb252ZXJ0RGF0ZVRvMTJoRm9ybWF0KGV2ZW50LmVuZERhdGEuc3RyaW5nKSA6IGV2ZW50LmVuZERhdGEuc3RyaW5nIH19XG4gICAgICAgICAgICA8L3NtYWxsPjwvcD5cIlxuICAgICAgICAgIFtvZmZzZXRdPTE1XG4gICAgICAgICAgKGNsaWNrKT1cIm9uRXZlbnRDbGljayhldmVudCk7ICRldmVudC5zdG9wUHJvcGFnYXRpb24oKVwiXG4gICAgICAgICAgKGRyYWdzdGFydCk9XCJvbkV2ZW50RHJhZ1N0YXJ0KGV2ZW50KVwiXG4gICAgICAgICAgKGRyYWdlbmQpPVwib25Ib3Vyc0V2ZW50RHJhZ0VuZChldmVudClcIlxuICAgICAgICAgIChtb3VzZWVudGVyKT1cIm9uTW91c2VFbnRlcihldmVudClcIlxuICAgICAgICAgIChtb3VzZWxlYXZlKT1cIm9uTW91c2VMZWF2ZSgpXCJcbiAgICAgICAgPlxuICAgICAgICAgIDxpIGNsYXNzPVwiZmFzIGZhLWNpcmNsZSBldmVudC1jaXJjbGUgcGUtMSB0ZXh0LXt7IGV2ZW50LmNvbG9yLmJhY2tncm91bmQgfX1cIj48L2k+XG4gICAgICAgICAge3tldmVudC5zdW1tYXJ5fX1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L3RkPlxuICAgIDwvdHI+XG4gIDwvdGJvZHk+XG48L3RhYmxlPiJdfQ==